const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/SuperTable.js","js/index.js","js/vendor.js","css/vendor.css","css/index.css"])))=>i.map(i=>d[i]);
import{_ as S,a as A}from"./index.js";import{ay as c,e as o,d as u,x as i,z as m,an as V,b3 as R,aq as b,ao as F,I as f,b4 as x,b5 as C,ar as L,am as k,b6 as Z,X as n,Z as M,aI as J,r as y,Y as T,$ as D,ap as z,b7 as W,ax as X,b8 as $,aB as I,_ as v,a3 as _,a2 as U,aC as j,ad as q,ai as ee,aj as te,b9 as le}from"./vendor.js";import{c as w,d as N,e as B,Q as ae,D as re,f as de,R as Q,C as oe,a as me}from"./SuperTable.js";const ie={name:"DateRangePicker",props:{hideLabel:{type:Boolean,default(){return!1}},modelValue:{type:String,default:null}},data(){return{showDialog:!1,showStartDatePicker:!1,showEndDatePicker:!1,showStartTimePicker:!1,showEndTimePicker:!1,startDate:null,endDate:null,startTime:null,endTime:null,selectedTimezone:"Africa/Johannesburg",duration:120}},computed:{formattedValue(){let a="";return this.formattedStartDate&&this.formattedStartTime&&this.formattedEndTime&&(this.startDate===this.endDate?a=`${this.formattedStartDate} 
${this.formattedStartTime} - ${this.formattedEndTime} (${this.selectedTimezone})`:a=`${this.formattedStartDate} ${this.formattedStartTime} -
${this.formattedEndDate} ${this.formattedEndTime} (${this.selectedTimezone})`),a},formattedStartDate(){return this.startDate?c.tz(this.startDate,this.selectedTimezone).format("dddd, MMMM D, YYYY"):""},formattedEndDate(){return this.endDate?c.tz(this.endDate,this.selectedTimezone).format("dddd, MMMM D, YYYY"):""},formattedStartTime(){return this.startTime?c.tz(this.startTime,"HH:mm:ss",this.selectedTimezone).format("h:mm A"):""},formattedEndTime(){return this.endTime?c.tz(this.endTime,"HH:mm:ss",this.selectedTimezone).format("h:mm A"):""},dateTimeRange(){return this.formattedStartDate&&this.formattedStartTime&&this.formattedEndTime?`${this.formattedStartDate} 
 ${this.formattedStartTime} - ${this.formattedEndTime} (Africa/Johannesburg)`:null},pgDateTimeRange(){const a=c(`${this.startDate} ${this.startTime}`).format("YYYY-MM-DD HH:mm:ssZZ"),l=c(`${this.endDate} ${this.endTime}`).format("YYYY-MM-DD HH:mm:ssZZ");return`"[${a},${l}]"`}},methods:{parseTstzrange(a){const l=a.match(/\[(.*?),(.*)\]/);if(l){const e=c.tz(l[1],this.selectedTimezone),h=c.tz(l[2],this.selectedTimezone);this.detectDuration(e.format("HH:mm:ss"),h.format("HH:mm:ss")),this.startDate=e.format("YYYY-MM-DD"),this.startTime=e.format("HH:mm:ss"),this.endDate=h.format("YYYY-MM-DD"),this.endTime=h.format("HH:mm:ss")}},setDefaultStartTime(){this.showStartDatePicker=!1;const a=c.tz(this.selectedTimezone);a.minutes(0).seconds(0).milliseconds(0).add(1,"hours"),this.startTime=a.format("HH:mm:ss"),this.endDate=this.startDate},getTimestampsForDatabase(){const a=c.tz(`${this.startDate} ${this.startTime}`,this.selectedTimezone).toISOString(),l=c.tz(`${this.endDate} ${this.endTime}`,this.selectedTimezone).toISOString();return`[${a}, ${l}]`},finalizeDateTimeRange(){const a=this.getTimestampsForDatabase();this.$emit("update:modelValue",a),this.showDialog=!1},manuallyChangedEndTime(a){this.detectDuration(this.startTime,a)},detectDuration(a,l){this.duration=c(l,"HH:mm:ss").diff(c(a,"HH:mm:ss"),"minutes")}},watch:{startTime(a){this.endTime=c(a,"HH:mm:ss").add(this.duration,"minutes").format("HH:mm:ss")}},mounted(){this.parseTstzrange(this.modelValue)}},se=f("div",{class:"text-h6"},"Start",-1),ne=f("div",{class:"text-h6"},"End",-1);function ue(a,l,e,h,d,t){return o(),u(Z,null,{default:i(()=>[m(V,{label:"Select Date Range",readonly:"",onClick:l[0]||(l[0]=r=>d.showDialog=!0),modelValue:t.formattedValue,"onUpdate:modelValue":l[1]||(l[1]=r=>t.formattedValue=r),error:!1,"error-message":"",filled:""},{append:i(()=>[m(R,{name:"event"})]),_:1},8,["modelValue"]),m(b,{modelValue:d.showDialog,"onUpdate:modelValue":l[18]||(l[18]=r=>d.showDialog=r),"max-width":"500px"},{default:i(()=>[m(F,{class:"q-pa-md"},{default:i(()=>[f("div",null,[se,m(V,{label:"Start Date",modelValue:t.formattedStartDate,"onUpdate:modelValue":l[2]||(l[2]=r=>t.formattedStartDate=r),error:!1,"error-message":"",readonly:"",onClick:l[3]||(l[3]=r=>d.showStartDatePicker=!0),filled:""},null,8,["modelValue"]),m(b,{modelValue:d.showStartDatePicker,"onUpdate:modelValue":l[5]||(l[5]=r=>d.showStartDatePicker=r),"max-width":"290px"},{default:i(()=>[m(x,{modelValue:d.startDate,"onUpdate:modelValue":[l[4]||(l[4]=r=>d.startDate=r),t.setDefaultStartTime],error:!1,"error-message":""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["modelValue"]),m(V,{label:"Start Time",modelValue:t.formattedStartTime,"onUpdate:modelValue":l[6]||(l[6]=r=>t.formattedStartTime=r),error:!1,"error-message":"",readonly:"",onClick:l[7]||(l[7]=r=>d.showStartTimePicker=!0),filled:""},null,8,["modelValue"]),m(b,{modelValue:d.showStartTimePicker,"onUpdate:modelValue":l[9]||(l[9]=r=>d.showStartTimePicker=r),"max-width":"290px"},{default:i(()=>[m(C,{modelValue:d.startTime,"onUpdate:modelValue":l[8]||(l[8]=r=>d.startTime=r)},null,8,["modelValue"])]),_:1},8,["modelValue"])]),f("div",null,[ne,m(V,{label:"End Date",modelValue:t.formattedEndDate,"onUpdate:modelValue":l[10]||(l[10]=r=>t.formattedEndDate=r),error:!1,"error-message":"",readonly:"",onClick:l[11]||(l[11]=r=>d.showEndDatePicker=!0),filled:""},null,8,["modelValue"]),m(b,{modelValue:d.showEndDatePicker,"onUpdate:modelValue":l[13]||(l[13]=r=>d.showEndDatePicker=r),"max-width":"290px"},{default:i(()=>[m(x,{modelValue:d.endDate,"onUpdate:modelValue":l[12]||(l[12]=r=>d.endDate=r)},null,8,["modelValue"])]),_:1},8,["modelValue"]),m(V,{label:"End Time",modelValue:t.formattedEndTime,"onUpdate:modelValue":l[14]||(l[14]=r=>t.formattedEndTime=r),error:!1,"error-message":"",readonly:"",onClick:l[15]||(l[15]=r=>d.showEndTimePicker=!0),filled:""},null,8,["modelValue"]),m(b,{modelValue:d.showEndTimePicker,"onUpdate:modelValue":l[17]||(l[17]=r=>d.showEndTimePicker=r),"max-width":"290px"},{default:i(()=>[m(C,{modelValue:d.endTime,"onUpdate:modelValue":[l[16]||(l[16]=r=>d.endTime=r),t.manuallyChangedEndTime]},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["modelValue"])]),m(L,{align:"right"},{default:i(()=>[m(k,{flat:"",label:"OK",color:"primary",onClick:t.finalizeDateTimeRange},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const G=S(ie,[["render",ue],["__file","DateAndTimeRangePicker.vue"]]),ce={name:"DateAndTimePicker",props:{hideLabel:{type:Boolean,default:!1},modelValue:{type:String,default:null},label:{type:String,default:""},disabled:{type:Boolean,default:!1},useTimezone:{type:Boolean,default:!1}},data(){return{showDialog:!1,showDatePicker:!1,showTimePicker:!1,selectedDate:null,selectedTime:null,selectedTimezone:"Africa/Johannesburg"}},computed:{formattedValue(){return this.formattedDate&&this.formattedTime?`${this.formattedDate} ${this.formattedTime}${this.useTimezone?` (${this.selectedTimezone})`:""}`:""},formattedDate(){return this.selectedDate?this.useTimezone?c.tz(this.selectedDate,this.selectedTimezone).format("dddd, MMMM D, YYYY"):c(this.selectedDate).format("dddd, MMMM D, YYYY"):""},formattedTime(){return this.selectedTime?this.useTimezone?c.tz(this.selectedTime,"HH:mm:ss",this.selectedTimezone).format("h:mm A"):c(this.selectedTime,"HH:mm:ss").format("h:mm A"):""}},methods:{click(){this.disabled||(this.showDialog=!0)},setDefaultStartTime(){const a=this.useTimezone?c.tz(this.selectedTimezone):c();a.minutes(0).seconds(0).milliseconds(0).add(1,"hours"),this.selectedTime=a.format("HH:mm:ss")},parseTimestamptz(a){if(a){const l=this.useTimezone?c.tz(a,this.selectedTimezone):c(a);this.selectedDate=l.format("YYYY-MM-DD"),this.selectedTime=l.format("HH:mm:ss")}},getTimestampForDatabase(){return this.useTimezone?c.tz(`${this.selectedDate} ${this.selectedTime}`,this.selectedTimezone).toISOString():c(`${this.selectedDate} ${this.selectedTime}`).format("YYYY-MM-DDTHH:mm:ss.SSS")},finalizeDateTime(){const a=this.getTimestampForDatabase();this.$emit("update:modelValue",a),this.showDialog=!1}},watch:{modelValue:{immediate:!0,handler(a){this.parseTimestamptz(a)}}}},fe=f("h3",null,"Select Date & Time",-1),he={class:"q-pa-md text-right"},Ve={class:"q-pa-md text-right"};function pe(a,l,e,h,d,t){return o(),n("div",null,[m(V,{label:"Select Date Range",readonly:"",onClick:t.click,modelValue:t.formattedValue,"onUpdate:modelValue":l[0]||(l[0]=r=>t.formattedValue=r),error:!1,"error-message":"",dense:"",filled:"",disable:e.disabled},{append:i(()=>[m(R,{name:"calendar_today"})]),_:1},8,["onClick","modelValue","disable"]),m(b,{modelValue:d.showDialog,"onUpdate:modelValue":l[11]||(l[11]=r=>d.showDialog=r),"max-width":"500px"},{default:i(()=>[m(F,{class:"q-pa-md"},{default:i(()=>[fe,m(V,{label:"Date",modelValue:t.formattedDate,"onUpdate:modelValue":l[1]||(l[1]=r=>t.formattedDate=r),error:!1,"error-message":"",readonly:"",onClick:l[2]||(l[2]=r=>d.showDatePicker=!0),dense:"",filled:""},null,8,["modelValue"]),m(b,{modelValue:d.showDatePicker,"onUpdate:modelValue":l[5]||(l[5]=r=>d.showDatePicker=r),"max-width":"290px"},{default:i(()=>[m(F,null,{default:i(()=>[m(x,{modelValue:d.selectedDate,"onUpdate:modelValue":[l[3]||(l[3]=r=>d.selectedDate=r),t.setDefaultStartTime]},null,8,["modelValue","onUpdate:modelValue"]),f("div",he,[m(k,{color:"primary",onClick:l[4]||(l[4]=r=>d.showDatePicker=!1)},{default:i(()=>[M("OK")]),_:1})])]),_:1})]),_:1},8,["modelValue"]),m(V,{label:"Time",modelValue:t.formattedTime,"onUpdate:modelValue":l[6]||(l[6]=r=>t.formattedTime=r),error:!1,"error-message":"",readonly:"",onClick:l[7]||(l[7]=r=>d.showTimePicker=!0),dense:"",filled:""},null,8,["modelValue"]),m(b,{modelValue:d.showTimePicker,"onUpdate:modelValue":l[10]||(l[10]=r=>d.showTimePicker=r),"max-width":"290px"},{default:i(()=>[m(F,null,{default:i(()=>[m(C,{modelValue:d.selectedTime,"onUpdate:modelValue":l[8]||(l[8]=r=>d.selectedTime=r)},null,8,["modelValue"]),f("div",Ve,[m(k,{color:"primary",onClick:l[9]||(l[9]=r=>d.showTimePicker=!1)},{default:i(()=>[M("OK")]),_:1})])]),_:1})]),_:1},8,["modelValue"]),m(L,null,{default:i(()=>[m(J),m(k,{color:"primary",onClick:t.finalizeDateTime},{default:i(()=>[M("OK")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const Te=S(ce,[["render",pe],["__file","DateAndTimePicker.vue"]]),ye=I(()=>A(()=>import("./SuperTable.js").then(a=>a.g),__vite__mapDeps([0,1,2,3,4]))),ge={name:"DatapointForEditInner",components:{SuperSelect:w,SearchGooglePlace:N,DateAndTimePicker:Te,DateAndTimeRangePicker:G,RelationComponent:B,SuperTable:ye},props:{disabled:{type:Boolean,default:!1},item:{type:Object,default:()=>({})},itemErrors:{type:Object,default:()=>({})},formServerErrors:{type:Object,default:()=>({})},hideLabel:{type:Boolean,default(){return!1}},modelValue:{type:[Object,String,Number,Boolean],default(){return null}},field:{type:Object,default(){return{}}},superOptions:{type:Object,default(){return{headers:[],modelFields:[],displayMapField:!1,model:{},canEdit:!1,currentParentRecord:{}}}}},data(){return{loading:!1}},computed:{itemPVal(){return this.item[this.superOptions.model.primaryKey]},compServerError(){let a=null;return this.formServerErrors&&this.formServerErrors.errors&&this.formServerErrors.errors[this.field.name]&&(a=this.formServerErrors.errors[this.field.name]),a},compError(){let a=null;return this.itemErrors&&this.itemErrors&&this.itemErrors[this.field.name]&&(a=`${this.field.label} is required.`),a},placeFieldsWithFieldNames(){let a=[];if(this.superOptions.modelFields.find(e=>e.usageType=="mapName"))for(const e of ae.mapPlaceFields()){const h=this.superOptions.modelFields.find(d=>d.usageType==e.flag);h&&a.push({...e,fieldNames:h.name})}return a},compLabel(){},compPlaceholder(){return this.field.label}},methods:{getForcedFilters(a){return typeof a.fieldExtras.linkablesRule=="function"?a.fieldExtras.linkablesRule():{}},handleFileUpload(a){a&&this.$emit("update:modelValue",a)},updateModelValue(a){this.$emit("update:modelValue",a)},updateStartTime(a){this.$emit("update:modelValue",a),this.$emit("updateSetDefaultEndTime",a)},async searchGooglePlace(a){}},mounted(){}},Ee={key:0,class:"q-mb-md"},De=["src"];function be(a,l,e,h,d,t){var O;const r=y("SuperTable"),s=y("RelationComponent"),p=y("SuperSelect"),g=y("DateAndTimeRangePicker"),E=y("DateAndTimePicker"),P=y("SearchGooglePlace");return o(),n("div",null,[e.field.dataType==="uid"?(o(),n(T,{key:0},[],64)):e.field.usageType.startsWith("rel")?(o(),n(T,{key:1},[e.field.usageType.startsWith("relLookup")?(o(),n(T,{key:0},[],64)):e.field.usageType.startsWith("relForeignKeyNormal")?(o(),u(r,{key:1,disabled:e.disabled,hideLabel:e.hideLabel,isForSelectingRelation:!0,canEdit:!1,modelValue:e.modelValue,"onUpdate:modelValue":t.updateModelValue,model:e.field.meta.field.parent,rules:[()=>!0],modelField:e.field,fetchFlags:{sort:e.field.meta.field.parent.titleKey},forcedFilters:t.getForcedFilters(e.field),onSuperTableMounted:l[0]||(l[0]=H=>a.$emit("superTableMounted")),errorMessage:t.compError},null,8,["disabled","hideLabel","modelValue","onUpdate:modelValue","model","modelField","fetchFlags","forcedFilters","errorMessage"])):e.field.usageType.startsWith("relForeignKeyMapExtraRel")?(o(),u(s,{key:2,hideLabel:e.hideLabel,configs:e.field,modelValue:e.modelValue,"onUpdate:modelValue":t.updateModelValue,readonly:""},null,8,["hideLabel","configs","modelValue","onUpdate:modelValue"])):e.field.usageType=="relForeignKeyOwnerAppliedToProviderType"?(o(),u(p,{key:3,hideLabel:e.hideLabel,modelField:e.field,modelValue:e.modelValue,"onUpdate:modelValue":t.updateModelValue,model:e.field.meta.field.parent,readonly:"",variant:"filled",density:"default"},null,8,["hideLabel","modelField","modelValue","onUpdate:modelValue","model"])):e.field.usageType!=="relChildrenNormal"?(o(),u(s,{key:4,hideLabel:e.hideLabel,configs:e.field,modelValue:e.modelValue,"onUpdate:modelValue":t.updateModelValue},null,8,["hideLabel","configs","modelValue","onUpdate:modelValue"])):D("",!0)],64)):e.field.usageType=="timeRangeType"?(o(),u(g,{key:2,label:t.compLabel,placeholder:t.compPlaceholder,modelValue:e.modelValue,"onUpdate:modelValue":t.updateModelValue,rules:e.field.meta.rules,error:!!t.compError,"error-message":t.compError},null,8,["label","placeholder","modelValue","onUpdate:modelValue","rules","error","error-message"])):e.field.usageType=="timeRangeStart"?(o(),u(E,{key:3,label:t.compLabel,placeholder:t.compPlaceholder,modelValue:e.modelValue,"onUpdate:modelValue":t.updateStartTime,rules:e.field.meta.rules,error:!!t.compError,"error-message":t.compError},null,8,["label","placeholder","modelValue","onUpdate:modelValue","rules","error","error-message"])):e.field.usageType=="timeRangeEnd"?(o(),u(E,{key:4,label:t.compLabel,placeholder:t.compPlaceholder,modelValue:e.modelValue,"onUpdate:modelValue":t.updateModelValue,rules:e.field.meta.rules,error:!!t.compError,"error-message":t.compError},null,8,["label","placeholder","modelValue","onUpdate:modelValue","rules","error","error-message"])):e.field.usageType=="timestampType"?(o(),u(V,{key:5,label:t.compLabel,placeholder:t.compPlaceholder,modelValue:e.modelValue,"onUpdate:modelValue":t.updateModelValue,rules:e.field.meta.rules,error:!!t.compError,"error-message":t.compError,type:"datetime-local",filled:"",dense:""},null,8,["label","placeholder","modelValue","onUpdate:modelValue","rules","error","error-message"])):e.field.usageType=="dateType"?(o(),u(V,{key:6,label:t.compLabel,placeholder:t.compPlaceholder,modelValue:e.modelValue,"onUpdate:modelValue":t.updateModelValue,rules:e.field.meta.rules,error:!!t.compError,"error-message":t.compError,type:"date",filled:"",dense:""},null,8,["label","placeholder","modelValue","onUpdate:modelValue","rules","error","error-message"])):e.field.usageType.startsWith("fileImageType")?(o(),n(T,{key:7},[t.itemPVal?(o(),n("div",Ee,[m(F,{style:{width:"unset","max-width":"unset"},flat:"",class:"bg-grey-2"},{default:i(()=>[m(z,{class:"q-pa-sm",style:{"text-align":"center"}},{default:i(()=>[typeof e.modelValue=="string"&&e.modelValue.length?(o(),n("img",{key:0,src:`${e.modelValue}`,alt:"File not found.",style:{"max-width":"100%","max-height":"200px"}},null,8,De)):(o(),n(T,{key:1},[M(" Images can only be set on create. ")],64))]),_:1})]),_:1})])):(o(),u(W,{key:1,modelValue:e.modelValue,"onUpdate:modelValue":t.handleFileUpload,label:t.compLabel,accept:".pdf,.jpg,.jpeg,.png",error:!!t.compError,"error-message":t.compError,class:"q-mb-md",filled:"",dense:""},{prepend:i(()=>[m(R,{name:"attach_file"})]),_:1},8,["modelValue","onUpdate:modelValue","label","error","error-message"]))],64)):e.field.usageType.startsWith("staticLookup")&&((O=e.field.fieldExtras.usageTypeExtras)!=null&&O.options)?(o(),u(X,{key:8,label:t.compLabel,placeholder:t.compPlaceholder,modelValue:e.modelValue,"onUpdate:modelValue":t.updateModelValue,"option-label":"label","option-value":"value",emitValue:"",mapOptions:"",rules:e.field.meta.rules,error:!!t.compError,"error-message":t.compError,options:e.field.fieldExtras.usageTypeExtras.options,filled:"",dense:""},null,8,["label","placeholder","modelValue","onUpdate:modelValue","rules","error","error-message","options"])):e.field.usageType=="readOnlyTimestampType"?(o(),u(E,{key:9,label:t.compLabel,placeholder:t.compPlaceholder,modelValue:e.modelValue,"onUpdate:modelValue":t.updateModelValue,rules:e.field.meta.rules,error:!!t.compError,"error-message":t.compError,disabled:""},null,8,["label","placeholder","modelValue","onUpdate:modelValue","rules","error","error-message"])):e.field.usageType==="mapName"?(o(),u(P,{key:10,hideLabel:e.hideLabel,configs:e.field,modelValue:e.modelValue,"onUpdate:modelValue":t.updateModelValue,onChange:t.searchGooglePlace},null,8,["hideLabel","configs","modelValue","onUpdate:modelValue","onChange"])):e.field.usageType.startsWith("mapExtra")?(o(),u(V,{key:11,label:t.compLabel,placeholder:t.compPlaceholder,modelValue:e.modelValue,"onUpdate:modelValue":t.updateModelValue,rules:e.field.meta.rules,error:!!t.compError,"error-message":t.compError,filled:"",dense:""},null,8,["label","placeholder","modelValue","onUpdate:modelValue","rules","error","error-message"])):e.field.usageType=="normal"?(o(),n(T,{key:12},[e.field.dataType==="string"?(o(),u(V,{key:0,label:t.compLabel,placeholder:t.compPlaceholder,modelValue:e.modelValue,"onUpdate:modelValue":t.updateModelValue,rules:e.field.meta.rules,error:!!t.compError,"error-message":t.compError,filled:"",dense:""},null,8,["label","placeholder","modelValue","onUpdate:modelValue","rules","error","error-message"])):e.field.dataType==="boolean"?(o(),u($,{key:1,label:t.compLabel,placeholder:t.compPlaceholder,modelValue:e.modelValue,"onUpdate:modelValue":t.updateModelValue,rules:e.field.meta.rules,error:!!t.compError,"error-message":t.compError},null,8,["label","placeholder","modelValue","onUpdate:modelValue","rules","error","error-message"])):e.field.dataType==="number"?(o(),u(V,{key:2,label:t.compLabel,placeholder:t.compPlaceholder,modelValue:e.modelValue,"onUpdate:modelValue":t.updateModelValue,rules:e.field.meta.rules,error:!!t.compError,"error-message":t.compError,type:"number",filled:"",dense:""},null,8,["label","placeholder","modelValue","onUpdate:modelValue","rules","error","error-message"])):e.field.dataType==="attr"?(o(),u(V,{key:3,label:t.compLabel,placeholder:t.compPlaceholder,modelValue:e.modelValue,"onUpdate:modelValue":t.updateModelValue,rules:e.field.meta.rules,error:!!t.compError,"error-message":t.compError,filled:"",dense:""},null,8,["label","placeholder","modelValue","onUpdate:modelValue","rules","error","error-message"])):D("",!0)],64)):(o(),u(V,{key:13,label:t.compLabel,placeholder:t.compPlaceholder,modelValue:e.modelValue,"onUpdate:modelValue":t.updateModelValue,rules:e.field.meta.rules,error:!!t.compError,"error-message":t.compError,filled:"",dense:""},null,8,["label","placeholder","modelValue","onUpdate:modelValue","rules","error","error-message"]))])}const Y=S(ge,[["render",be],["__file","DatapointForEditInner.vue"]]),Se={name:"DatapointForEdit",components:{DatapointForDisplayInner:re,DatapointForEditInner:Y},props:{itemErrors:{type:Object,default:()=>({})},formServerErrors:{type:Object,default:()=>({})},compField:{type:Object,default(){return{}}},dataPoint:{type:Object,default(){return{}}},modelValue:{type:[Object,String,Number,Boolean],default(){return null}},superOptions:{type:Object,default(){return{headers:[],modelFields:[],displayMapField:!1,model:{},canEdit:!1,currentParentRecord:{}}}}},data(){return{}},computed:{label(){return typeof this.dataPoint.label!="undefined"?this.dataPoint.label:this.dataPoint.type==="function"?"":this.compField?this.compField.label:""}},methods:{updateModelValue(a,l){this.itemData[l]=a,this.$emit("update:modelValue",this.itemData)}},mounted(){this.itemData=this.modelValue}},Fe={key:0,class:""},ke={class:"row"},ve={class:"q-pr-sm col-6 col-md-6 col-sm-6 col-xs-6"},Pe={class:"text-subtitle2",style:{"line-height":"3em"}},_e={class:"col-6 col-md-6 col-sm-6 col-xs-6"},Ue=["innerHTML"],Oe=["innerHTML"];function Me(a,l,e,h,d,t){const r=y("DatapointForEditInner");return o(),n("div",null,[e.dataPoint.xOrientation?(o(),n("div",Fe,[f("div",ke,[f("div",ve,[f("div",Pe,v(t.label)+": ",1)]),f("div",_e,[(o(),u(j(e.dataPoint.tag?e.dataPoint.tag:"div"),{class:_(e.dataPoint.class?e.dataPoint.class:""),style:U(e.dataPoint.style?e.dataPoint.style:"")},{default:i(()=>[e.dataPoint.type==="function"?(o(),n("div",{key:0,innerHTML:e.dataPoint.function(e.modelValue)},null,8,Ue)):(o(),n(T,{key:1},[e.compField?(o(),u(r,{key:0,item:e.modelValue,modelValue:e.modelValue[e.compField.name],"onUpdate:modelValue":l[0]||(l[0]=s=>{t.updateModelValue(s,e.compField.name)}),superOptions:e.superOptions,onUpdateSetDefaultEndTime:l[1]||(l[1]=s=>{a.$emit("updateSetDefaultEndTime",s)}),field:e.compField,hideLabel:"",formServerErrors:e.formServerErrors},null,8,["item","modelValue","superOptions","field","formServerErrors"])):D("",!0)],64))]),_:1},8,["class","style"]))])])])):(o(),n(T,{key:1},[e.dataPoint.hideLabel?D("",!0):(o(),n("div",{key:0,class:"text-subtitle2",style:U(`visibility: ${t.label.length?"visible":"hidden"}`)},v(t.label)+": ",5)),(o(),u(j(e.dataPoint.tag?e.dataPoint.tag:"div"),{class:_(e.dataPoint.class?e.dataPoint.class:""),style:U(e.dataPoint.style?e.dataPoint.style:"")},{default:i(()=>[e.dataPoint.type==="function"?(o(),n("div",{key:0,innerHTML:e.dataPoint.function(e.modelValue)},null,8,Oe)):(o(),n(T,{key:1},[e.compField?(o(),u(r,{key:0,item:e.modelValue,modelValue:e.modelValue[e.compField.name],"onUpdate:modelValue":l[2]||(l[2]=s=>{t.updateModelValue(s,e.compField.name)}),superOptions:e.superOptions,onUpdateSetDefaultEndTime:l[3]||(l[3]=s=>{a.$emit("updateSetDefaultEndTime",s)}),field:e.compField,hideLabel:"",formServerErrors:e.formServerErrors,itemErrors:e.itemErrors},null,8,["item","modelValue","superOptions","field","formServerErrors","itemErrors"])):D("",!0)],64))]),_:1},8,["class","style"]))],64))])}const we=S(Se,[["render",Me],["__file","DatapointForEdit.vue"]]),xe={name:"RecordFieldsForEditCustom",components:{DatapointForEdit:we,DatapointForDisplay:de,RecordFieldsForDisplayCustom:Q,SuperSelect:w,DatapointForEditInner:Y},props:{formServerErrors:{type:Object,default:()=>({})},itemErrors:{type:Object,default:()=>({})},template:{type:Object,default(){return{}}},modelValue:{type:Object,default:()=>({})},superOptions:{type:Object,default(){return{headers:[],modelFields:[],displayMapField:!1,model:{},canEdit:!1,currentParentRecord:{}}}}},data(){return{loading:!1}},computed:{compField(){var a;return((a=this.template.dataPoint)==null?void 0:a.type)==="function"?{label:this.template.dataPoint.label}:this.superOptions.modelFields.find(e=>e.field==this.template.dataPoint.field)}},mounted(){},methods:{colClasses(a=12){a=+a;const l={lg:1,md:1.5,sm:2,xs:4};function e(s){return[1,2,3,4,6,12].reduce((g,E)=>Math.abs(E-s)<Math.abs(g-s)?E:g)}const h=e(a*l.lg),d=e(a*l.md),t=e(a*l.sm),r=e(a*l.xs);return`col-${h} col-lg-${h} col-md-${d} col-sm-${t} col-xs-${r}`},updateModelValue(a){this.$emit("update:modelValue",a)}},watch:{}},Ce={style:{"padding-top":"0.03px"}},ze={key:1,class:"col-12"};function Re(a,l,e,h,d,t){var p,g,E;const r=y("RecordFieldsForEditCustom",!0),s=y("DatapointForEdit");return o(),n("div",{class:_(t.colClasses(e.template.width?e.template.width:12))},[f("div",Ce,[f("div",{class:_(["row",`${e.template.unsetGutters?"":"q-col-gutter-xs"} ${(p=e.template.class)!=null&&p.length?e.template.class:""} `]),style:U(`${(g=e.template.style)!=null&&g.length?e.template.style:""}`)},[(E=e.template.cols)!=null&&E.length?(o(!0),n(T,{key:0},q(e.template.cols,(P,O)=>(o(),u(r,{key:O,modelValue:e.modelValue,"onUpdate:modelValue":t.updateModelValue,superOptions:e.superOptions,onUpdateSetDefaultEndTime:l[0]||(l[0]=H=>{a.$emit("updateSetDefaultEndTime",H)}),template:P,formServerErrors:e.formServerErrors,itemErrors:e.itemErrors},null,8,["modelValue","onUpdate:modelValue","superOptions","template","formServerErrors","itemErrors"]))),128)):e.template.dataPoint&&!t.compField.meta.hideField?(o(),n("div",ze,[f("div",{class:_(e.template.dataPoint.noMargin?"":"q-mb-sm")},[m(s,{modelValue:e.modelValue,compField:t.compField,"onUpdate:modelValue":t.updateModelValue,superOptions:e.superOptions,onUpdateSetDefaultEndTime:l[1]||(l[1]=P=>{a.$emit("updateSetDefaultEndTime",P)}),dataPoint:e.template.dataPoint,formServerErrors:e.formServerErrors,itemErrors:e.itemErrors},null,8,["modelValue","compField","onUpdate:modelValue","superOptions","dataPoint","formServerErrors","itemErrors"])],2)])):D("",!0)],6)])],2)}const K=S(xe,[["render",Re],["__file","RecordFieldsForEditCustom.vue"]]),Le={name:"RecordFieldsForEditGeneric",components:{RecordFieldsForEditCustom:K,SuperSelect:w,DatapointForEditInner:Y},props:{itemErrors:{type:Object,default:()=>({})},formServerErrors:{type:Object,default:()=>({})},modelValue:{type:Object,default:()=>({})},superOptions:{type:Object,default(){return{headers:[],modelFields:[],displayMapField:!1,model:{},canEdit:!1,currentParentRecord:{}}}}},data(){return{rendered:!1,itemData:this.modelValue,loading:!1}},mounted(){this.itemData=this.modelValue,this.autoFillAll()},methods:{updateModelValue(a,l){this.itemData[l]=a,this.$emit("update:modelValue",this.itemData)},autoFillAll(){for(const a of this.superOptions.modelFields)typeof a.fieldExtras.autoFill=="function"&&(this.itemData[a.name]=a.fieldExtras.autoFill(this.itemData));this.$emit("update:modelValue",this.itemData)}},watch:{itemData:{handler(){this.autoFillAll()},deep:!0}}},Ye={key:0,class:"q-mb-sm"};function He(a,l,e,h,d,t){const r=y("DatapointForEditInner");return o(),n("div",null,[(o(!0),n(T,null,q(e.superOptions.modelFields,s=>(o(),n(T,{key:s.name},[e.superOptions.model.primaryKey!==s.name&&!s.meta.hideField?ee((o(),n("div",Ye,[["relLookupNormal","relChildrenNormal"].includes(s.usageType)?D("",!0):(o(),n(T,{key:0},[d.rendered?(o(),n("div",{key:0,class:"text-subtitle2",style:U(`visibility: ${s.label.length?"visible":"hidden"}`)},v(s.label)+": ",5)):D("",!0),m(r,{onSuperTableMounted:l[0]||(l[0]=p=>d.rendered=!0),item:d.itemData,modelValue:d.itemData[s.name],"onUpdate:modelValue":p=>{t.updateModelValue(p,s.name)},superOptions:e.superOptions,onUpdateSetDefaultEndTime:l[1]||(l[1]=p=>{a.$emit("updateSetDefaultEndTime",p)}),field:s,formServerErrors:e.formServerErrors,itemErrors:e.itemErrors,hideLabel:""},null,8,["item","modelValue","onUpdate:modelValue","superOptions","field","formServerErrors","itemErrors"])],64))],512)),[[te,typeof s.fieldExtras.autoFill!="function"]]):D("",!0)],64))),128))])}const je=S(Le,[["render",He],["__file","RecordFieldsForEditGeneric.vue"]]),Ae=I(()=>A(()=>import("./SuperTable.js").then(a=>a.g),__vite__mapDeps([0,1,2,3,4]))),Ie={name:"CreateEditForm",components:{CreateButton:oe,RecordFieldsForEditCustom:K,RecordFieldsForDisplayCustom:Q,RecordFieldsForDisplayGeneric:me,RecordFieldsForEditGeneric:je,SuperSelect:w,SearchGooglePlace:N,DateAndTimeRangePicker:G,RelationComponent:B,SuperTable:Ae},props:{template:{type:Object,default(){return{}}},titlePrefix:{type:String,default:()=>""},modelValue:{type:Object,default:()=>({})},formServerErrors:{type:Object,default:()=>({})},superOptions:{type:Object,default(){return{headers:[],modelFields:[],displayMapField:!1,model:{},canEdit:!1,currentParentRecord:{}}}}},data(){return{itemData:this.modelValue,loading:!1,itemErrors:{}}},methods:{updateSetDefaultEndTime(a){const l=this.superOptions.modelFields.find(e=>e.usageType==="timeRangeEnd");this.itemData[l.name]=c(a).add(2,"hours").format("YYYY-MM-DDTHH:mm:ss.SSS")},cancel(){this.$emit("cancel")},updateModelValue(a){this.$emit("update:modelValue",a)},getRequiredFields(){return this.superOptions.modelFields.filter(a=>a.meta&&a.meta.required).map(a=>a.name)},validateField(a,l){l?delete this.itemErrors[a]:this.itemErrors[a]="Required"},validateForm(){return this.itemErrors={},this.getRequiredFields().forEach(l=>{this.validateField(l,this.modelValue[l])}),Object.keys(this.itemErrors).length===0},async editItemSubmit(){this.validateForm()&&this.$emit("submit")}},mounted(){}},qe={class:"text-h6"},Ne={key:0,style:{"padding-top":"0.03px"}},Be={class:"row q-col-gutter-xs"},Qe={style:{width:"100%"}},Ge={class:"text-right text-negative"},Ke={class:"text-right"};function Ze(a,l,e,h,d,t){const r=y("RecordFieldsForEditCustom"),s=y("RecordFieldsForEditGeneric");return o(),u(F,{class:""},{default:i(()=>[m(z,null,{default:i(()=>{var p,g;return[f("div",qe,v(e.titlePrefix)+" "+v((p=e.superOptions.model)!=null&&p.entityName?(g=e.superOptions.model)==null?void 0:g.entityName:"Item"),1)]}),_:1}),m(z,null,{default:i(()=>[m(le,{ref:"editForm"},{default:i(()=>[e.template&&e.template.cols?(o(),n("div",Ne,[f("div",Be,[m(r,{modelValue:d.itemData,"onUpdate:modelValue":t.updateModelValue,superOptions:e.superOptions,onUpdateSetDefaultEndTime:t.updateSetDefaultEndTime,template:e.template,formServerErrors:e.formServerErrors,itemErrors:d.itemErrors},null,8,["modelValue","onUpdate:modelValue","superOptions","onUpdateSetDefaultEndTime","template","formServerErrors","itemErrors"])])])):(o(),u(s,{key:1,modelValue:d.itemData,"onUpdate:modelValue":t.updateModelValue,superOptions:e.superOptions,onUpdateSetDefaultEndTime:t.updateSetDefaultEndTime,formServerErrors:e.formServerErrors,itemErrors:d.itemErrors},null,8,["modelValue","onUpdate:modelValue","superOptions","onUpdateSetDefaultEndTime","formServerErrors","itemErrors"]))]),_:1},512)]),_:1}),m(L,null,{default:i(()=>[f("div",Qe,[f("div",Ge,v(Object.keys(d.itemErrors).length?`${Object.keys(d.itemErrors)[0]} is required${Object.keys(d.itemErrors).length>1?" (and "+(Object.keys(d.itemErrors).length-1)+" more error/s).":"."} `:""),1),f("div",Ke,[m(k,{flat:"",label:"Cancel",onClick:t.cancel},null,8,["onClick"]),m(k,{flat:"",label:"Save",color:"primary",onClick:t.editItemSubmit,loading:d.loading},null,8,["onClick","loading"])])])]),_:1})]),_:1})}const $e=S(Ie,[["render",Ze],["__file","CreateEditForm.vue"]]);export{$e as default};
