const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/CreateEditForm.js","js/index.js","js/vendor.js","css/vendor.css","css/index.css"])))=>i.map(i=>d[i]);
import{_ as F,a as Q,D as X}from"./index.js";import{e as n,X as d,z as o,x as m,Z as v,_ as D,d as f,al as W,I as _,$ as g,am as x,A as ye,r as k,an as A,ao as P,ap as R,aq as L,ar as ee,as as ge,at as be,au as H,av as $,aa as B,aw as ce,ag as te,ax as E,ay as w,Y as b,az as ke,W as G,a2 as M,aA as ie,a3 as V,ad as O,aB as z,aC as U,aD as se,aE as _e,aF as Ie,aG as we,aH as he,aI as Fe,aJ as ve,aK as De,aL as Ce,aM as Me,aN as Te,aO as Oe,aP as q,aQ as xe,aR as ne,aS as re,aT as de,aU as oe,aV as Se,aW as Ve,aX as Pe,aY as Re,aZ as ue,a_ as Ee}from"./vendor.js";const Le={name:"CreateButton",props:{createButtonText:{type:String,default:""},model:{type:[Object,Function],required:!0},superOptions:{type:Object,default(){return{headers:[],modelFields:[],displayMapField:!1,model:{},canEdit:!1,currentParentRecord:{}}}}},computed:{canCreate(){return!1},canCreateMsgType(){return""},canCreatePart2(){return this.canCreate},canEdit(){return this.model.rules.creatable()},canCreateMsg(){return this.getMsg(this.canCreateMsgType)}},methods:{emitCreateItem(e){this.$emit("createItem",e)},getMsg(e){return""}},mounted(){}};function Ae(e,t,l,s,i,a){return n(),d("div",null,[o(x,{onClick:a.emitCreateItem,disable:!a.canEdit,outline:""},{default:m(()=>[v(D(l.createButtonText?l.createButtonText:"New")+" ",1),a.canCreateMsg.length?(n(),f(W,{key:0,bottom:"",disable:a.canCreatePart2},{default:m(()=>[_("span",null,D(a.canCreateMsg),1)]),_:1},8,["disable"])):g("",!0)]),_:1},8,["onClick","disable"])])}const Be=F(Le,[["render",Ae],["__file","CreateButton.vue"]]),Ke={name:"RelationComponent",components:{SuperTable:()=>Q(()=>Promise.resolve().then(()=>le),void 0)},props:{hideLabel:{type:Boolean,default(){return!1}},configs:{type:Object,default:()=>({})},lookup:{type:Number,default:null},modelValue:{type:Number,default:null},readonly:{type:Boolean,default:!1},rules:{type:Array,default(){return[()=>!0]}}},data(){return{showRelationDialog:!1,newlookup:{}}},computed:{isNullable(){return this.configs.meta.field.parent.fields()[this.foreignKey].isNullable},displayNameField(){const e=this.configs.meta.field.parent.fields();return Object.keys(e).find(t=>t!=="id"&&e[t]instanceof ye)},computedValue:{get(){let e="";const t=this.configs.meta.field.parent.query().whereId(+this.modelValue).get();return t.length&&(e=t[0][this.configs.meta.lookupDisplayField]),e},set(e){this.$emit("update:modelValue",e)}}},methods:{input(e){this.newlookup=e,this.showRelationDialog=!1,this.$emit("update:modelValue",e.id)},click(){this.readonly||(this.showRelationDialog=!0)}}},Ye=_("div",{class:"text-h6"},"Select Item",-1);function Ne(e,t,l,s,i,a){const u=k("SuperTable");return n(),d("div",null,[o(A,{onClick:a.click,label:l.configs.label,modelValue:a.computedValue,rules:l.configs.meta.rules,error:!1,"error-message":"",readonly:"",disable:l.readonly,outlined:"",dense:""},null,8,["onClick","label","modelValue","rules","disable"]),o(L,{modelValue:i.showRelationDialog,"onUpdate:modelValue":t[0]||(t[0]=r=>i.showRelationDialog=r),"max-width":"800px"},{default:m(()=>[o(P,null,{default:m(()=>[o(R,null,{default:m(()=>[Ye]),_:1}),o(R,null,{default:m(()=>[o(u,{isForSelectingRelation:!0,canEdit:!1,modelValue:l.modelValue,"onUpdate:modelValue":a.input,model:l.configs.meta.field.parent,rules:l.rules},null,8,["modelValue","onUpdate:modelValue","model","rules"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const Ge=F(Ke,[["render",Ne],["__file","RelationComponent.vue"]]),qe={name:"SearchGooglePlace",props:{hideLabel:{type:Boolean,default(){return!1}},modelValue:{type:String,default:null},configs:{type:Object,default:()=>({})}},data(){return{showDialog:!1,retries:0,place:null,internalModelValue:this.modelValue}},watch:{modelValue(e){this.internalModelValue=e},showDialog(e){e&&this.tryInit()}},methods:{emitPlaceChanged(e){this.place=e,e.geometry&&(this.internalModelValue=e.name,this.$emit("update:modelValue",e.name))},initAutocomplete(){const e=this.$refs.autocompleteInput.$el.querySelector("input"),t=new window.google.maps.places.Autocomplete(e);t.addListener("place_changed",()=>{const l=t.getPlace();this.emitPlaceChanged(l)})},tryInit(){this.$refs.autocompleteInput&&window.google&&window.google.maps&&window.google.maps.places?this.initAutocomplete():this.retries<5?(this.retries++,setTimeout(this.tryInit,1e3)):console.error("Failed to load Google Maps API after multiple attempts.")}}},je=e=>(ge("data-v-e415eb54"),e=e(),be(),e),Ue=je(()=>_("h3",null,"Search Place",-1)),We={style:{display:"none"}};function He(e,t,l,s,i,a){const u=k("GMapAutocomplete");return n(),d("div",null,[o(A,{label:l.configs.label,modelValue:i.internalModelValue,"onUpdate:modelValue":t[0]||(t[0]=r=>i.internalModelValue=r),error:!1,"error-message":"",onClick:t[1]||(t[1]=r=>i.showDialog=!0),readonly:"",outlined:"",dense:""},null,8,["label","modelValue"]),o(L,{modelValue:i.showDialog,"onUpdate:modelValue":t[4]||(t[4]=r=>i.showDialog=r),"max-width":"500px"},{default:m(()=>[o(P,null,{default:m(()=>[o(R,null,{default:m(()=>[Ue,o(A,{class:"CustomPlaceSearch",label:"Place",modelValue:i.internalModelValue,"onUpdate:modelValue":t[2]||(t[2]=r=>i.internalModelValue=r),error:!1,"error-message":"",ref:"autocompleteInput",outlined:"",dense:""},null,8,["modelValue"])]),_:1}),o(ee,{align:"right"},{default:m(()=>[o(x,{color:"primary",onClick:t[3]||(t[3]=r=>i.showDialog=!1)},{default:m(()=>[v("OK")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),_("div",We,[o(u,{placeholder:"This is a placeholder",onPlace_changed:a.emitPlaceChanged},null,8,["onPlace_changed"])])])}const ze=F(qe,[["render",He],["__scopeId","data-v-e415eb54"],["__file","SearchGooglePlace.vue"]]);class C{static quickListsIsMobile(){return!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}static mapPlaceFields(){return[{flag:"mapExtraFormattedAddress",googleType:"simple",googleName:"formatted_address"},{flag:"mapExtraPlaceID",googleType:"simple",googleName:"place_id"},{flag:"mapExtraGeoLocLong",googleType:"mapGeoLoc",googleName:"lng"},{flag:"mapExtraGeoLocLat",googleType:"mapGeoLoc",googleName:"lat"},{flag:"relForeignKeyMapExtraRelCountry",googleType:"components",googleName:"country"},{flag:"relForeignKeyMapExtraRelAdminArea1",googleType:"components",googleName:"administrative_area_level_1"},{flag:"relForeignKeyMapExtraRelAdminArea2",googleType:"components",googleName:"administrative_area_level_2"},{flag:"relForeignKeyMapExtraRelLocality",googleType:"components",googleName:"locality"},{flag:"relForeignKeyMapExtraRelSublocality",googleType:"components",googleName:["sublocality_level_1","sublocality_level_2"]}]}static quickListsGetIfMatchesAllChecks(t,l){for(const[s,i]of Object.entries(l))if(typeof i=="object"&&!Array.isArray(i)&&i!==null){if(i!=null&&i.value&&i.usageType==="timeRangeStart"&&i.value.range.start){const a=new Date(i.value.range.start),u=new Date(i.value.range.end),r=new Date(t[s]);return a<r&&r<u}}else if(i!==null)return t[s]==i;return!0}static computedAttrs(t,l=[]){let s=X.find(t.entity);return s||(X.Generate(t),s=X.find(t.entity)),this.computedAttrs2(s.fields,l)}static computedAttrs2(t,l=[]){let s=[];for(const i of t)i.usageType.startsWith("relLookupNormal")?l.includes(i.meta.foreignKey)?s.push({...i,meta:{...i.meta,hideField:!0}}):s.push({...i,meta:{...i.meta,hideField:!1}}):l.includes(i.name)?s.push({...i,meta:{...i.meta,hideField:!0}}):s.push({...i,meta:{...i.meta,hideField:!1}});return s}static SupaerTableHeaders(t,l=[],s=!0,i=!1){let a=[];const u=this.computedAttrs(t,l);for(const r of u)if(!r.usageType.startsWith("relForeignKey"))if(r.usageType.startsWith("relLookup")){const c=this.computedAttrs(r.meta.field.parent,l);let h=[];for(const p of c)p.usageType.startsWith("relForeignKey")||h.push({usageType:p.usageType,dataType:p.dataType,meta:p.meta,name:`${r.name}.${p.name}`,align:"left",label:p.label,field:I=>I[r.name]&&I[r.name][p.name],format:I=>`${I}`,sortable:!0});a.push({usageType:r.usageType,dataType:r.dataType,meta:r.meta,headerParentFields:h,name:r.name,align:"left",label:r.label,field:r.name,sortable:!0,children:h})}else a.push({usageType:r.usageType,dataType:r.dataType,meta:r.meta,name:r.name,align:"left",label:r.label,field:r.name,sortable:!0});return s&&a.push({usageType:"actions",dataType:"actions",name:"actions",align:"right",label:"Actions",field:"actions",sortable:!1}),a=a.filter(r=>{if(i){if(!r.usageType.startsWith("relForeignKey"))return!0}else return!r.usageType.startsWith("relForeignKey")&&!r.usageType.startsWith("relLookupMapExtra")&&!r.usageType.startsWith("mapExtra")}),a}static preparePayload(t,l){let s=[];for(const i of l)typeof(t==null?void 0:t[i.name])!="undefined"&&(i.usageType.startsWith("relForeignKey")?s[i.meta.foreignKey]=t[i.meta.foreignKey]:i.usageType.startsWith("relLookup")||i.usageType.startsWith("relChildren")||(["timestampType","readOnlyTimestampType","timeRangeStart","timeRangeEnd"].includes(i.usageType)?t[i.name]&&(s[i.name]=t[i.name]):s[i.name]=t[i.name]));return delete s.$id,s}}const Qe={name:"SuperSelect",props:{errorMessage:{type:String,default(){return null}},hideLabel:{type:Boolean,default(){return!1}},maxPages:{type:[Number,Object],default:1},page:{type:[Number,Object],default:1},modelValue:{type:[Number,Object,String],default:null},model:{type:[Object,Function],required:!0},disabled:{type:Boolean,default:!1},modelField:{type:Object,default:()=>({})},displayMapField:{type:Boolean,default:!1},excludedCols:{type:Array,default:()=>[]},readonly:{type:Boolean,default:!1},variant:{type:String,default:"outlined"},density:{type:String,default:"compact"},allowAll:{type:Boolean,default:!1},rules:{type:Array,default:()=>[()=>!0]},items:{type:Array,default(){return[]}},activated:{type:Boolean,default(){return!1}},loading:{type:Boolean,default(){return!1}}},data(){return{timeout:null,search:"",totalPages:1,preSelectedItem:null,loadingInner:!1}},computed:{compLabel(){if(!this.hideLabel)return this.modelField.label},compLoading(){return this.loadingInner||this.loading},disabledComp(){return this.disabled||this.readonly},quickListsIsMobile(){return C.quickListsIsMobile()},headers(){return C.SupaerTableHeaders(this.model,this.excludedCols,!1,this.displayMapField)},itemsComp(){let e=[];if(!this.disabled){if(e.push({label:"",id:null}),this.allowAll&&e.push({label:"All",id:null}),!this.activated){e=e.filter(l=>l.id!==this.modelValue);let t="";this.preSelectedItem&&(t=this.preSelectedItem[this.model.titleKey]),e.push({label:t,id:this.modelValue})}for(const t of this.items)e.push({label:t[this.model.titleKey],id:t[this.model.primaryKey]});e.push({label:"",id:null})}return e}},methods:{pageUpdate(e){this.$emit("update:page",e)},updateValue(e){const t={};t[this.model.primaryKey]=e,this.$emit("update:modelValue",e,t)},fetchDefaultItem(){this.modelValue&&!this.items.length&&(this.loadingInner=!0,this.model.FetchById(this.modelValue,[],{},{}).then(e=>{this.preSelectedItem=e.response.data.data,this.loadingInner=!1}).catch(()=>{this.loadingInner=!1}))}},watch:{search(e){this.disabled||(this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.$emit("search",e)},300))},modelValue(e){this.fetchDefaultItem()}},mounted(){this.fetchDefaultItem()}},Ze={class:"q-mb-md"};function Je(e,t,l,s,i,a){return n(),d("div",null,[o(E,{style:{"min-width":"200px"},modelValue:l.modelValue,"onUpdate:modelValue":a.updateValue,options:a.itemsComp,"option-label":"label","option-value":l.model.primaryKey,"emit-value":!0,"map-options":!0,label:a.compLabel,disable:a.disabledComp,loading:a.compLoading,readonly:l.readonly,dense:l.density==="compact",filled:"","menu-props":{offsetY:!0},rules:l.rules,error:!!l.errorMessage,errorMessage:l.errorMessage},{option:m(u=>[u.index===0?(n(),f(H,{key:0,class:"q-mt-none q-px-md"},{default:m(()=>[o($,null,{default:m(()=>[_("div",Ze,[B(e.$slots,"default")]),o(A,{modelValue:i.search,"onUpdate:modelValue":t[0]||(t[0]=r=>i.search=r),error:!1,"error-message":"",label:"Search",dense:"",outlined:"","single-line":"","hide-bottom-space":"",class:"q-mt-none q-pa-none"},null,8,["modelValue"])]),_:3})]),_:3})):u.index===a.itemsComp.length-1?(n(),f(H,{key:1,class:"text-center q-pa-md"},{default:m(()=>[o(ce,{modelValue:l.page,max:l.maxPages,"onUpdate:modelValue":a.pageUpdate,input:""},null,8,["modelValue","max","onUpdate:modelValue"])]),_:1})):(n(),f(H,te({key:2},u.itemProps,{key:u.index,label:u.opt.label,value:u.opt.id}),{default:m(()=>[o($,null,{default:m(()=>[_("div",null,D(u.opt.label),1)]),_:2},1024)]),_:2},1040,["label","value"]))]),_:3},8,["modelValue","onUpdate:modelValue","options","option-value","label","disable","loading","readonly","dense","rules","error","errorMessage"])])}const pe=F(Qe,[["render",Je],["__file","SuperSelect.vue"]]),Xe={name:"DatapointForDisplayInner",components:{},props:{isTag:{type:Boolean,default(){return!1}},isHeading:{type:Boolean,default(){return!1}},hideLabel:{type:Boolean,default(){return!1}},header:{type:Object,default(){return{}}},item:{type:Object,default(){return{}}},superOptions:{type:Object,default(){return{headers:[],modelFields:[],displayMapField:!1,model:{},canEdit:!1,currentParentRecord:{}}}}},methods:{clickParent(e,t){const l=t.meta.field.parent;l.openRecord(e[l.primaryKey],e,this.$router)},truncateStr(e){let t="";return e&&(t=e.length>40?e.substring(0,40)+"...":e),t},disabled(){var t;let e=!1;return(t=this.superOptions.model.rules)!=null&&t.editable&&(e=this.superOptions.model.rules.editable(this.item)),!e},deleteItem(e){this.$emit("deleteItem",e)},editItem(e){this.$emit("editItem",e)},formatTimestamp(e){return e?w.tz(e,"YYYY-MM-DDTHH:mm:ss.SSSSSSZ","UTC").tz("Africa/Johannesburg").format("dddd, MMMM D, YYYY h:mm A"):null}}},$e={key:1,class:"text-caption"},et={key:0,class:"absolute-full text-subtitle2 flex flex-center"},tt=["title"];function lt(e,t,l,s,i,a){var u,r;return n(),d("div",{class:V(l.isHeading?"text-h6":"")},[typeof l.header.usageType=="undefined"?(n(),d(b,{key:0},[],64)):!l.isHeading&&!l.hideLabel&&!l.header.usageType.startsWith("relChildren")?(n(),d("div",$e,D(l.header.label),1)):g("",!0),typeof l.header.usageType=="undefined"?(n(),d(b,{key:2},[v(D(typeof l.header.usageType),1)],64)):l.header.usageType.startsWith("relChildren")?(n(),d(b,{key:3},[],64)):l.header.usageType=="readOnlyTimestampType"||l.header.usageType=="timestampType"||l.header.usageType=="timeRangeStart"||l.header.usageType=="timeRangeEnd"?(n(),d(b,{key:4},[v(D(a.formatTimestamp(l.item[l.header.field])),1)],64)):l.header.usageType.startsWith("fileImageType")?(n(),f(P,{key:5,style:{width:"unset","max-width":"unset"},flat:"",class:"bg-grey-2"},{default:m(()=>[o(R,{class:"q-pa-sm"},{default:m(()=>[o(ke,{alt:"File not found.",src:`${l.item[l.header.field]}`},{default:m(()=>[l.item[l.header.field]?g("",!0):(n(),d("div",et," Oops, no image found! "))]),_:1},8,["src"])]),_:1})]),_:1})):l.header.usageType=="actions"?(n(),d("div",{key:6,onClick:t[2]||(t[2]=G(()=>{},["stop"])),style:M(a.disabled()?"cursor: default;":"")},[o(x,{onClick:t[0]||(t[0]=G(c=>a.editItem(l.item),["stop"])),disable:a.disabled(),color:"grey",icon:"edit",flat:"",size:"sm"},null,8,["disable"]),o(x,{onClick:t[1]||(t[1]=G(c=>a.deleteItem(l.item),["stop"])),disable:a.disabled(),color:"grey",icon:"delete",flat:"",size:"sm"},null,8,["disable"])],4)):l.header.usageType.startsWith("relLookup")?(n(),d("div",{key:7,style:{"min-height":"32px",cursor:"pointer"},onClick:t[3]||(t[3]=G(c=>{var h;return a.clickParent((h=l.item)==null?void 0:h[l.header.field],l.header)},["stop"]))},[(r=(u=l.item)==null?void 0:u[l.header.field])!=null&&r[l.header.meta.lookupDisplayField]?(n(),f(ie,{key:0},{default:m(()=>{var c,h;return[v(D((h=(c=l.item)==null?void 0:c[l.header.field])==null?void 0:h[l.header.meta.lookupDisplayField]),1)]}),_:1})):g("",!0)])):(n(),d(b,{key:8},[l.isTag?(n(),d("div",{key:0,onClick:t[4]||(t[4]=G(c=>a.clickParent(l.item),["stop"])),style:{cursor:"pointer"}},[l.isTag?(n(),f(ie,{key:0},{default:m(()=>[v(D(l.item[l.header.field]),1)]),_:1})):g("",!0)])):(n(),d("div",{key:1,title:l.item[l.header.field]},D(a.truncateStr(l.item[l.header.field])),9,tt))],64))],2)}const K=F(Xe,[["render",lt],["__file","DatapointForDisplayInner.vue"]]),at={name:"RecordFieldsForDisplayGeneric",components:{DatapointForDisplayInner:K},props:{unClickable:{type:Boolean,default(){return!1}},maxFields:{type:Number,default(){return 999}},item:{type:Object,default(){return{}}},superOptions:{type:Object,default(){return{headers:[],modelFields:[],displayMapField:!1,model:{},canEdit:!1,currentParentRecord:{}}}}},methods:{deleteItem(e){this.$emit("deleteItem",e)},editItem(e){this.$emit("editItem",e)},clickRow(e){this.$emit("clickRow",e)}}},it={key:1},st={key:1},nt={key:1};function rt(e,t,l,s,i,a){const u=k("DatapointForDisplayInner");return n(),d("div",{style:M(l.unClickable?"":"cursor: pointer"),onClick:t[0]||(t[0]=r=>a.clickRow(l.item)),class:"q-pa-sm"},[(n(!0),d(b,null,O(l.superOptions.headers,(r,c)=>(n(),d(b,null,[r.field!=="id"&&(c<l.maxFields||r.usageType==="actions")&&!r.usageType.startsWith("relChildren")?(n(),d("div",{key:r.name,class:"q-pa-xs q-mb-sm",style:{"min-height":"1.375rem"}},[c<2?(n(),d(b,{key:0},[l.superOptions.headers[0].value==="id"?(n(),d(b,{key:0},[c===0?(n(),d(b,{key:0},[],64)):(n(),d("div",it,[o(u,{header:r,item:l.item,superOptions:l.superOptions,onEditItem:a.editItem,onDeleteItem:a.deleteItem},null,8,["header","item","superOptions","onEditItem","onDeleteItem"])]))],64)):(n(),d(b,{key:1},[c===0?(n(),f(u,{key:0,header:r,item:l.item,superOptions:l.superOptions,onEditItem:a.editItem,onDeleteItem:a.deleteItem,isHeading:""},null,8,["header","item","superOptions","onEditItem","onDeleteItem"])):(n(),d("div",st,[(n(),f(u,{key:c,header:r,item:l.item,superOptions:l.superOptions,onEditItem:a.editItem,onDeleteItem:a.deleteItem},null,8,["header","item","superOptions","onEditItem","onDeleteItem"]))]))],64))],64)):(n(),d("div",nt,[(n(),f(u,{key:c,header:r,item:l.item,superOptions:l.superOptions,onEditItem:a.editItem,onDeleteItem:a.deleteItem},null,8,["header","item","superOptions","onEditItem","onDeleteItem"]))]))])):g("",!0)],64))),256))],4)}const j=F(at,[["render",rt],["__file","RecordFieldsForDisplayGeneric.vue"]]),dt={name:"DatapointForDisplay",components:{RecordFieldsForDisplayGeneric:j,SuperTable:z(()=>Q(()=>Promise.resolve().then(()=>le),void 0)),DatapointForDisplayInner:K},props:{header:{type:Object,default(){return null}},hideLabel:{type:Boolean,default(){return!1}},dataPoint:{type:Object,default(){return{}}},item:{type:Object,default(){return{}}},childRelations:{type:Array,default(){return[]}},superOptions:{type:Object,default(){return{headers:[],modelFields:[],displayMapField:!1,model:{},canEdit:!1,currentParentRecord:{}}}}},computed:{asyncComponent(){return this.dataPoint.type==="component"&&this.dataPoint.componentPath?z(this.dataPoint.componentPath):null},compField(){return this.header?this.header:this.dataPoint.type==="component"||this.dataPoint.type==="function"?{label:this.dataPoint.label}:this.superOptions.headers.find(t=>t.field==this.dataPoint.field)},compRelation(){let e={};return this.compField&&this.isRelChildren(this.compField)&&(e=this.childRelations.find(t=>t.field.name==this.dataPoint.field)),console.log(e),e},label(){return typeof this.dataPoint.label!="undefined"?this.dataPoint.label:this.dataPoint.type==="component"||this.dataPoint.type==="function"?"":this.compField?this.compField.label:""}},methods:{deleteItem(e){this.$emit("deleteItem",e)},editItem(e){this.$emit("editItem",e)},isRelChildren(e){return(e==null?void 0:e.usageType)&&(e==null?void 0:e.usageType.startsWith("relChildren"))}}},ot={key:0},ut={key:0,class:""},mt={class:"row",style:{"align-items":"center"}},ct={key:0,class:"q-pr-sm"},ht={class:"text-subtitle2",style:{display:"flex","align-items":"center"}},pt=["innerHTML"],ft=["innerHTML"];function yt(e,t,l,s,i,a){var r,c;const u=k("DatapointForDisplayInner");return!((r=a.compField)!=null&&r.meta)||!((c=a.compField.meta)!=null&&c.hideField)?(n(),d("div",ot,[l.dataPoint.xOrientation?(n(),d("div",ut,[_("div",mt,[l.dataPoint.hideLabel?g("",!0):(n(),d("div",ct,[_("div",ht,D(a.label)+": ",1)])),_("div",null,[(n(),f(U(l.dataPoint.tag?l.dataPoint.tag:"div"),{class:V(l.dataPoint.class?l.dataPoint.class:""),style:M(l.dataPoint.style?l.dataPoint.style:"")},{default:m(()=>[l.dataPoint.type==="component"?(n(),f(U(a.asyncComponent),{key:0,item:l.item},null,8,["item"])):l.dataPoint.type==="function"?(n(),d("div",{key:1,innerHTML:l.dataPoint.function(l.item)},null,8,pt)):(n(),f(u,{key:2,header:a.compField,item:l.item,superOptions:l.superOptions,hideLabel:"",onEditItem:a.editItem,onDeleteItem:a.deleteItem},null,8,["header","item","superOptions","onEditItem","onDeleteItem"]))]),_:1},8,["class","style"]))])])])):(n(),d(b,{key:1},[!l.dataPoint.hideLabel&&!l.hideLabel?(n(),d("div",{key:0,class:"text-subtitle2",style:M(`visibility: ${a.label.length?"visible":"hidden"}`)},D(a.label)+": ",5)):g("",!0),(n(),f(U(l.dataPoint.tag?l.dataPoint.tag:"div"),{class:V(l.dataPoint.class?l.dataPoint.class:""),style:M(l.dataPoint.style?l.dataPoint.style:"")},{default:m(()=>[l.dataPoint.type==="component"?(n(),f(U(a.asyncComponent),{key:0,item:l.item,superOptions:l.superOptions,onEditItem:a.editItem,onDeleteItem:a.deleteItem},null,40,["item","superOptions","onEditItem","onDeleteItem"])):l.dataPoint.type==="function"?(n(),d("div",{key:1,innerHTML:l.dataPoint.function(l.item)},null,8,ft)):(n(),f(u,{key:2,header:a.compField,item:l.item,superOptions:l.superOptions,hideLabel:"",onEditItem:a.editItem,onDeleteItem:a.deleteItem},null,8,["header","item","superOptions","onEditItem","onDeleteItem"]))]),_:1},8,["class","style"]))],64))])):g("",!0)}const fe=F(dt,[["render",yt],["__file","DatapointForDisplay.vue"]]),gt={name:"RecordFieldsForDisplayCustom",components:{DatapointForDisplay:fe},props:{template:{type:Object,default(){return{}}},item:{type:Object,default(){return{}}},unClickable:{type:Boolean,default(){return!1}},childRelations:{type:Array,default(){return[]}},superOptions:{type:Object,default(){return{headers:[],modelFields:[],displayMapField:!1,model:{},canEdit:!1,currentParentRecord:{}}}}},computed:{},methods:{colClasses(e=12){e=+e;const t={lg:1,md:1.5,sm:2,xs:4};function l(r){return[1,2,3,4,6,12].reduce((h,p)=>Math.abs(p-r)<Math.abs(h-r)?p:h)}const s=l(e*t.lg),i=l(e*t.md),a=l(e*t.sm),u=l(e*t.xs);return`col-${s} col-lg-${s} col-md-${i} col-sm-${a} col-xs-${u}`},deleteItem(e){this.$emit("deleteItem",e)},editItem(e){this.$emit("editItem",e)},clickRow(e){this.$emit("clickRow",e)}}},bt={style:{"padding-top":"0.03px"}},kt={key:1,class:"col-12"};function _t(e,t,l,s,i,a){var c,h,p;const u=k("RecordFieldsForDisplayCustom",!0),r=k("DatapointForDisplay");return n(),d("div",{style:M(l.unClickable?"":"cursor: pointer"),onClick:t[0]||(t[0]=I=>a.clickRow(l.item)),class:V(a.colClasses(l.template.width?l.template.width:12))},[_("div",bt,[_("div",{class:V(["row",`${l.template.unsetGutters?"":"q-col-gutter-xs"} ${(c=l.template.class)!=null&&c.length?l.template.class:""} `]),style:M(`${(h=l.template.style)!=null&&h.length?l.template.style:""}`)},[(p=l.template.cols)!=null&&p.length?(n(!0),d(b,{key:0},O(l.template.cols,(I,S)=>(n(),f(u,{key:S,template:I,item:l.item,childRelations:l.childRelations,superOptions:l.superOptions,unClickable:l.unClickable,onEditItem:a.editItem,onDeleteItem:a.deleteItem},se({_:2},[O(e.$slots,(T,Y)=>({name:Y,fn:m(J=>[B(e.$slots,Y,te({ref_for:!0},J))])}))]),1032,["template","item","childRelations","superOptions","unClickable","onEditItem","onDeleteItem"]))),128)):l.template.dataPoint?(n(),d("div",kt,[o(r,{item:l.item,dataPoint:l.template.dataPoint,childRelations:l.childRelations,superOptions:l.superOptions,onEditItem:a.editItem,onDeleteItem:a.deleteItem},se({_:2},[O(e.$slots,(I,S)=>({name:S,fn:m(T=>[B(e.$slots,S,_e(Ie(T)))])}))]),1032,["item","dataPoint","childRelations","superOptions","onEditItem","onDeleteItem"])])):g("",!0)],6)])],6)}const Z=F(gt,[["render",_t],["__file","RecordFieldsForDisplayCustom.vue"]]),It={name:"DestructableExpansionPanels",props:{destroy:{type:Boolean,default(){return!1}},title:{type:String,default(){return""}}}},wt={class:"text-h6"},Ft={class:""};function vt(e,t,l,s,i,a){return n(),d("div",null,[l.destroy?B(e.$slots,"default",{key:0}):(n(),f(we,{key:1},{header:m(()=>[_("div",wt,D(l.title),1)]),default:m(()=>[_("div",Ft,[B(e.$slots,"default")])]),_:3}))])}const Dt=F(It,[["render",vt],["__file","DestructableExpansionPanels.vue"]]),Ct={name:"FilterPlace",components:{SuperSelect:pe},props:{filterField:{type:Object,default:()=>({})},modelValue:{type:Object,default:()=>({})}},data(){return{menu:!1,filtersData:[],placeFieldLevelTypes:["relForeignKeyMapExtraRelCountry","relForeignKeyMapExtraRelAdminArea1","relForeignKeyMapExtraRelAdminArea2","relForeignKeyMapExtraRelLocality","relForeignKeyMapExtraRelSublocality"],parentRelationships:{relForeignKeyMapExtraRelCountry:null,relForeignKeyMapExtraRelAdminArea1:"relForeignKeyMapExtraRelCountry",relForeignKeyMapExtraRelAdminArea2:"relForeignKeyMapExtraRelAdminArea1",relForeignKeyMapExtraRelLocality:"relForeignKeyMapExtraRelAdminArea2",relForeignKeyMapExtraRelSublocality:"relForeignKeyMapExtraRelLocality"}}},computed:{displayPlace(){let e="";const t=this.filterField.children;for(let l of this.placeFieldLevelTypes){let s=t.find(i=>i.usageType===l);if(s&&this.filtersData[s.name]&&this.filtersData[s.name]){let i=this.fetchDisplayNameFromVuex(s.meta.field.parent,this.filtersData[s.name]);i&&(e=i)}}return e}},methods:{handleSelectChange(e){const t=this.filterField.children.find(l=>l.name===e);if(t){const l=this.getChildFields(t.usageType);for(let s of l){const i=this.filterField.children.find(a=>a.usageType===s);i&&this.filtersData[i.name]&&(this.filtersData[i.name]=null)}}},getChildFields(e){const t=this.placeFieldLevelTypes.indexOf(e);return t===-1||t===this.placeFieldLevelTypes.length-1?[]:this.placeFieldLevelTypes.slice(t+1)},fetchDisplayNameFromVuex(e,t){let l="PlaceholderName";return l=e.query().whereId(t).first()[this.title(e).name],l},title(e){return C.computedAttrs(e).find(s=>s.name!=="id")},filterParentName(e){const t=this.parentRelationships[e.usageType];let l=null;if(t){const s=this.filterField.children.find(i=>i.usageType==t);s&&(l=s.name)}return l},getFilters(e){const t=this.filterParentName(e),l=this.modelValue[t]?{parent_id:this.modelValue[t]}:{};return JSON.stringify(l)}},watch:{filtersData:{handler(e){this.$emit("update:modelValue",e)},deep:!0}},mounted(){this.filtersData=this.modelValue}},Mt={key:0,class:"q-mt-md"};function Tt(e,t,l,s,i,a){const u=k("SuperSelect");return n(),d("div",null,[o(he,{modelValue:i.menu,"onUpdate:modelValue":t[2]||(t[2]=r=>i.menu=r),fit:"",class:"q-pt-none","no-corner":""},{activator:m(({attrs:r})=>[o(A,te(r,{label:"Place Filter",type:"text",modelValue:a.displayPlace,"onUpdate:modelValue":t[0]||(t[0]=c=>a.displayPlace=c),error:!1,"error-message":"",readonly:"",dense:"",outlined:"",placeholder:"All"}),null,16,["modelValue"])]),default:m(()=>[o(P,null,{default:m(()=>[o(R,null,{default:m(()=>[(n(!0),d(b,null,O(l.filterField.children,r=>(n(),d(b,{key:r.name},[r.usageType.startsWith("relForeignKeyMapExtraRel")?(n(),d("div",Mt,[typeof i.filtersData[r.name]!="undefined"?(n(),f(u,{key:0,allowAll:"",modelField:r,model:r.meta.field.parent,filters:a.getFilters(r),modelValue:i.filtersData[r.name],"onUpdate:modelValue":[c=>i.filtersData[r.name]=c,c=>a.handleSelectChange(r.name)],disabled:a.filterParentName(r)&&!l.modelValue[a.filterParentName(r)]},null,8,["modelField","model","filters","modelValue","onUpdate:modelValue","disabled"])):g("",!0)])):g("",!0)],64))),128)),o(x,{color:"primary",class:"q-mt-md",onClick:t[1]||(t[1]=r=>i.menu=!1)},{default:m(()=>[v("OK")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const Ot=F(Ct,[["render",Tt],["__file","FilterPlace.vue"]]),xt={name:"FilterTime",props:{modelField:{type:Object,default(){return{}}},modelValue:{type:Object,default:()=>({year:null,month:null,week:null,day:null,range:{start:null,end:null}})}},data(){return{years:this.generateYears(),months:[],weeks:[],days:[],menu:!1}},computed:{displayDate(){if(this.selectedDay)return w(this.selectedDay).format("ddd, MMM D, YYYY");if(this.selectedWeek){const e=w().year(this.selectedYear).month(this.selectedMonth-1).isoWeek(this.selectedWeek).startOf("isoWeek"),t=e.clone().endOf("isoWeek");return e.month()===t.month()?`${e.format("ddd D")} - ${t.format("ddd D, MMM, YYYY")}`:`${e.format("ddd D, MMM")} - ${t.format("ddd D, MMM, YYYY")}`}return this.selectedMonth?w(`${this.selectedYear}-${this.selectedMonth}-01`).format("MMM, YYYY"):this.selectedYear?this.selectedYear.toString():""},selectedYear:{get(){var e,t;return(e=this.modelValue)!=null&&e.year?(t=this.modelValue)==null?void 0:t.year:null},set(e){const t={...this.modelValue,year:e,month:null,week:null,day:null};this.$emit("update:modelValue",{...t,range:this.computeRange(t)}),this.months=this.generateMonths()}},selectedMonth:{get(){var e,t;return(e=this.modelValue)!=null&&e.month?(t=this.modelValue)==null?void 0:t.month:null},set(e){const t={...this.modelValue,month:e,week:null,day:null};this.$emit("update:modelValue",{...t,range:this.computeRange(t)}),this.weeks=this.generateWeeks(this.selectedYear,e)}},selectedWeek:{get(){var e,t;return(e=this.modelValue)!=null&&e.week?(t=this.modelValue)==null?void 0:t.week:null},set(e){const t={...this.modelValue,week:e,day:null};this.$emit("update:modelValue",{...t,range:this.computeRange(t)}),this.days=this.generateDays(this.selectedYear,this.selectedMonth,e)}},selectedDay:{get(){var e,t;return(e=this.modelValue)!=null&&e.day?(t=this.modelValue)==null?void 0:t.day:null},set(e){const t={...this.modelValue,day:e};this.$emit("update:modelValue",{...t,range:this.computeRange(t)})}}},methods:{toggleMenu(){this.menu=!this.menu},computeRange(e){let t,l;return e.day?(t=w(e.day).startOf("day"),l=w(e.day).add(1,"day").startOf("day")):e.week?(t=w().year(e.year).isoWeek(e.week).isoWeekday(1),l=t.clone().endOf("isoWeek")):e.month?(t=w(`${e.year}-${e.month}-01`,"YYYY-MM-DD"),l=t.clone().endOf("month")):e.year&&(t=w(`${e.year}-01-01`,"YYYY-MM-DD"),l=w(`${e.year}-12-31`,"YYYY-MM-DD")),{start:t?t.format("YYYY-MM-DD"):null,end:l?l.format("YYYY-MM-DD"):null}},generateYears(){const e=w().year(),t=[];t.push({label:"All",value:null});for(let l=0;l<10;l++){let s=e-l,i=s;s===e&&(i=`${s} (Current Year)`),t.push({label:i,value:s})}return t},generateMonths(){const e=[];e.push({label:"All",value:null});const t=w().month();for(let l=0;l<12;l++){let s=w().month(l).format("MMMM");l===t&&(s=`${s} (Current Month)`),e.push({label:s,value:+w().month(l).format("MM")})}return e},generateWeeks(e,t){const l=w(`${e}-${t}-01`,"YYYY-MM-DD").startOf("month"),s=l.clone().endOf("month"),i=[];i.push({label:"All",value:null});let a=1;const u=w();for(;l<=s;){const r=l.clone().startOf("isoWeek"),c=r.clone().endOf("isoWeek");let h;r.month()===c.month()?h=`Week ${a} (${r.format("MMM D dd")} - ${c.format("D dd")})`:h=`Week ${a} (${r.format("MMM D dd")} - ${c.format("MMM D dd")})`,u.isBetween(r,c,null,"[]")&&(h=`${h} (Current Week)`),i.push({label:h,value:r.isoWeek()}),l.add(1,"week"),++a}return i},generateDays(e,t,l){const s=l,i=w().year(e).isoWeek(s).isoWeekday(1),a=i.clone().endOf("isoWeek"),u=[],r=w().format("YYYY-MM-DD");for(;i<=a;){let p=i.format("dd, Do");i.format("YYYY-MM-DD")===r&&(p=`${p} (Today)`),u.push({label:p,value:i.format("YYYY-MM-DD")}),i.add(1,"day")}const c=u.filter(p=>+w(p.value).format("MM")===t);return[{label:"All",value:null},...c]}},mounted(){this.filtersData=this.modelValue}};function St(e,t,l,s,i,a){return n(),d("div",null,[o(A,{label:"Time Filter",type:"text",modelValue:a.displayDate,"onUpdate:modelValue":t[0]||(t[0]=u=>a.displayDate=u),error:!1,"error-message":"",disable:"",filled:"",dense:"",onClick:a.toggleMenu,class:"FilterTimeTrigger"},null,8,["modelValue","onClick"]),o(he,{modelValue:i.menu,"onUpdate:modelValue":t[6]||(t[6]=u=>i.menu=u),fit:"",class:"q-pt-none","no-corner":"","close-on-content-click":!1},{default:m(()=>[o(P,null,{default:m(()=>[o(R,null,{default:m(()=>[o(E,{options:i.years,modelValue:a.selectedYear,"onUpdate:modelValue":t[1]||(t[1]=u=>a.selectedYear=u),label:"Year","option-label":"label","option-value":"value",dense:"",filled:"",emitValue:"",mapOptions:"",class:"q-mb-sm"},null,8,["options","modelValue"]),o(E,{options:i.months,modelValue:a.selectedMonth,"onUpdate:modelValue":t[2]||(t[2]=u=>a.selectedMonth=u),label:"Month",disable:!a.selectedYear,"option-label":"label","option-value":"value",dense:"",filled:"",emitValue:"",mapOptions:"",class:"q-mb-sm"},null,8,["options","modelValue","disable"]),o(E,{options:i.weeks,modelValue:a.selectedWeek,"onUpdate:modelValue":t[3]||(t[3]=u=>a.selectedWeek=u),label:"Week",disable:!a.selectedMonth,"option-label":"label","option-value":"value",dense:"",filled:"",emitValue:"",mapOptions:"",class:"q-mb-sm"},null,8,["options","modelValue","disable"]),o(E,{options:i.days,modelValue:a.selectedDay,"onUpdate:modelValue":t[4]||(t[4]=u=>a.selectedDay=u),label:"Day",disable:!a.selectedWeek,"option-label":"label","option-value":"value",dense:"",filled:"",emitValue:"",mapOptions:"",class:"q-mb-sm"},null,8,["options","modelValue","disable"]),o(ee,null,{default:m(()=>[o(Fe),o(x,{color:"primary",onClick:t[5]||(t[5]=u=>i.menu=!1)},{default:m(()=>[v("OK")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const Vt=F(xt,[["render",St],["__file","FilterTime.vue"]]),Pt="data:image/svg+xml,%3csvg%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2043%2043'%20width='43px'%20height='43px'%20%3e%3ccircle%20fill='%23ef3061'%20cx='21.5'%20cy='21.5'%20r='11.5'%20/%3e%3cpath%20d='%20M%2035.988887394336025%2017.617714323462188%20A%2015%2015,%200,%200,%201,%2025.382285676537812%2035.988887394336025%20M%2017.617714323462188%2035.988887394336025%20A%2015%2015,%200,%200,%201,%207.011112605663973%2017.617714323462195%20M%2010.893398282201785%2010.893398282201789%20A%2015%2015,%200,%200,%201,%2032.10660171779821%2010.893398282201785%20'%20stroke='%23ef3061'%20stroke-width='3'%20stroke-linecap='round'%20fill='transparent'%20opacity='0.7'%20/%3e%3cpath%20d='%20M%2041.5%2021.5%20A%2020%2020,%200,%200,%201,%2031.5%2038.82050807568877%20M%2011.500000000000004%2038.82050807568878%20A%2020%2020,%200,%200,%201,%201.5%2021.500000000000004%20M%2011.499999999999991%204.1794919243112325%20A%2020%2020,%200,%200,%201,%2031.5%204.179491924311229%20'%20stroke='%23ef3061'%20stroke-width='3'%20stroke-linecap='round'%20fill='transparent'%20opacity='0.4'%20/%3e%3c/svg%3e",me="data:image/svg+xml,%3csvg%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20512%20512'%20width='24px'%20height='24px'%20className='flex'%20%3e%3cpath%20fill='%23fbfbfb'%20d='M454.848,198.848c0,159.225-179.751,306.689-179.751,306.689c-10.503,8.617-27.692,8.617-38.195,0c0,0-179.751-147.464-179.751-306.689C57.153,89.027,146.18,0,256,0S454.848,89.027,454.848,198.848z'%20/%3e%3cpath%20fill='%23ef3061'%20d='M454.848,198.848c0,159.225-179.751,306.689-179.751,306.689c-10.503,8.617-27.692,8.617-38.195,0c0,0-179.751-147.464-179.751-306.689C57.153,89.027,146.18,0,256,0S454.848,89.027,454.848,198.848z'%20/%3e%3cpath%20fill='%23fbfbfb'%20d='M256,298.89c-55.164,0-100.041-44.879-100.041-100.041S200.838,98.806,256,98.806s100.041,44.879,100.041,100.041S311.164,298.89,256,298.89z'%20/%3e%3c/svg%3e",Rt={name:"MyGoogleMap",components:{InocanGoogleMap:ve,InocanMarker:De,InocanMarkerCluster:Ce},props:{markers:{type:Array,default(){return[]}},modelValue:{type:Object,default(){return{}}},zoom:{type:Number,default(){return 2}}},data(){return{selectedPlaceIndex:null,VITE_API_GOOGLE_MAP_KEY:"AIzaSyAENUjZ_P7ulkAcDb-U8Htn6VSv_ioEKWE",iconAndLabelLabel:{icon:{url:Pt},label:{color:"white"}}}},computed:{clusterStyles(){return[{...this.clusterStyle,height:40,width:40},{...this.clusterStyle,height:40,width:40},{...this.clusterStyle,height:40,width:40},{...this.clusterStyle,height:40,width:40},{...this.clusterStyle,height:40,width:40}]}},methods:{iconAndLabelLabelMethod(e){return{icon:this.iconAndLabelLabel.icon,label:{text:String(e),...this.iconAndLabelLabel.label}}},clusterOptions(e){return{renderer:{render:({count:t,position:l})=>new e.Marker({position:l,...this.iconAndLabelLabelMethod(t),zIndex:999+t})}}},markerOptions(e){return{url:me,size:{width:30,height:30,f:"px",b:"px"},scaledSize:{width:30,height:30,f:"px",b:"px"}}},selectedMarkerOptions(e){return{id:e.meta.id,url:me,size:{width:40,height:40,f:"px",b:"px"},scaledSize:{width:40,height:40,f:"px",b:"px"}}},markerOptionsMethod(e,t){return t===this.selectedPlaceIndex?this.selectedMarkerOptions(e):this.markerOptions(e)},position(e){return{lng:Number(e.lng),lat:Number(e.lat)}},clickedMarker(e,t){this.$emit("update:modelValue",e.position),this.selectedPlaceIndex=t,this.$emit("clickMarker",e,t)}}};function Et(e,t,l,s,i,a){const u=k("InocanMarker"),r=k("InocanMarkerCluster"),c=k("InocanGoogleMap");return n(),d("div",null,[o(c,{"api-key":i.VITE_API_GOOGLE_MAP_KEY,center:l.modelValue,zoom:l.zoom,"map-type-id":"roadmap",style:{height:"calc(100vh - 222px)",width:"100%"}},{default:m(({api:h})=>[o(r,{options:a.clusterOptions(h)},{default:m(()=>[(n(!0),d(b,null,O(l.markers,(p,I)=>(n(),f(u,{key:I,onClick:S=>a.clickedMarker(p,I),options:{position:p.position,icon:a.markerOptionsMethod(p,I)}},null,8,["onClick","options"]))),128))]),_:2},1032,["options"])]),_:1},8,["api-key","center","zoom"])])}const Lt=F(Rt,[["render",Et],["__file","MyGoogleMap.vue"]]),At={};function Bt(e,t){return n(),d("div",null,[o(x,{"no-caps":"",class:"button",style:{margin:"2px"},onClick:t[0]||(t[0]=l=>e.$emit("prev")),unelevated:"",icon:"arrow_left"},{default:m(()=>[v(" Previous ")]),_:1}),o(x,{"no-caps":"",class:"button",style:{margin:"2px"},onClick:t[1]||(t[1]=l=>e.$emit("today")),unelevated:""},{default:m(()=>[v(" Now ")]),_:1}),o(x,{"no-caps":"",class:"button",style:{margin:"2px"},onClick:t[2]||(t[2]=l=>e.$emit("next")),unelevated:"","icon-right":"arrow_right"},{default:m(()=>[v(" Next ")]),_:1})])}const Kt=F(At,[["render",Bt],["__file","CalendarNavigationBar.vue"]]),Yt={name:"SuperTableCalendar",components:{RecordFieldsForDisplayCustom:Z,DatapointForDisplayInner:K,RecordFieldsForDisplayGeneric:j,CalendarNavigationBar:Kt,QCalendarDay:Me},props:{loading:{type:Boolean,default(){return!1}},templateListGrid:{type:Object,default(){return{}}},unClickable:{type:Boolean,default(){return!1}},items:{type:Array,default(){return[]}},superOptions:{type:Object,default(){return{headers:[],modelFields:[],displayMapField:!1,model:{},canEdit:!1,currentParentRecord:{}}}}},data(){return{view:"week",mode:"stack",modes:["stack","column"],weekday:[1,2,3,4,5,6,0],weekdays:[{title:"Sun - Sat",value:[0,1,2,3,4,5,6]},{title:"Mon - Sun",value:[1,2,3,4,5,6,0]},{title:"Mon - Fri",value:[1,2,3,4,5]},{title:"Mon, Wed, Fri",value:[1,3,5]}],colors:["blue","indigo","deep-purple","cyan","green","orange","grey darken-1"],viewItemData:{showModal:!1,data:{}},selectedDate:Te(),currentDate:null,currentTime:null,timeStartPos:0}},computed:{firstNonIdKey(){const e=Object.keys(this.superOptions.headers).find(s=>this.superOptions.headers[s].name!=="id");let t=this.superOptions.headers[e].name;if(!this.superOptions.headers.find(s=>s.usageType=="timeRangeStart")){for(const s of this.superOptions.headers)if(s.headerParentFields&&s.headerParentFields.find(a=>a.usageType=="timeRangeStart")){const a=C.SupaerTableHeaders(s.meta.relatedModel,[],[],[]),u=Object.keys(a).find(r=>a[r].name!=="id");t=[s.name,a[u].name]}}return t},startFieldName(){let e=this.superOptions.headers.find(t=>t.usageType=="timeRangeStart");if(!e){for(const t of this.superOptions.headers)if(t.headerParentFields){const l=t.headerParentFields.find(s=>s.usageType=="timeRangeStart");if(l){e={...l,isChildOf:t};break}}}return e},endFieldName(){let e=this.superOptions.headers.find(t=>t.usageType=="timeRangeEnd");if(!e){for(const t of this.superOptions.headers)if(t.headerParentFields&&(e=t.headerParentFields.find(l=>l.usageType=="timeRangeEnd"),e)){e={...e,isChildOf:t};break}}return e},events(){var t;let e=[];if((t=this.startFieldName)!=null&&t.name||this.startFieldName.isChildOf)for(const l of this.items){let s,i;if(console.log("111"),this.startFieldName.isChildOf){const c=this.startFieldName.name.split(".");s=new Date(l[c[0]][c[1]]);const h=this.endFieldName.name.split(".");i=new Date(l[h[0]][h[1]])}else s=new Date(l[this.startFieldName.name]),i=new Date(l[this.endFieldName.name]);let a="";Array.isArray(this.firstNonIdKey)?a=l[this.firstNonIdKey[0]][this.firstNonIdKey[1]]:a=l[this.firstNonIdKey];const u=(i-s)/1e3/60,r=s.toISOString().substr(11,5);e.push({id:a,title:a,date:s.toISOString().substr(0,10),time:r,duration:u,bgcolor:"deep-purple",icon:"fas fa-calendar-alt",meta:l})}return e},style(){return{top:this.timeStartPos+"px"}},eventsMap(){const e={};return this.events.forEach(t=>{if(e[t.date]||(e[t.date]=[]),e[t.date].push(t),t.days){let l=Oe(t.date),s=t.days;do l=q(l,{day:1}),e[l.date]||(e[l.date]=[]),e[l.date].push(t);while(--s>0)}}),e}},methods:{deleteItem(e){this.$emit("deleteItem",e)},editItem(e){this.$emit("editItem",e)},clickRow(e){this.viewItemData.showModal=!1,this.$emit("clickRow",e[this.superOptions.model.primaryKey],e)},updateTimeWindow(){},getEventColor(e){return e.color},rnd(e,t){return Math.floor((t-e+1)*Math.random())+e},showEvent(e){this.viewItemData.showModal=!0,this.viewItemData.data=e.meta},viewDay({date:e}){this.selectedDate=e,this.view="day"},prevPeriod(){this.$refs.calendar.prev()},nextPeriod(){this.$refs.calendar.next()},hasDate(e){return this.currentDate?e.find(t=>t.date===this.currentDate):!1},adjustCurrentTime(){const e=xe(new Date);this.currentDate=e.date,this.currentTime=e.time,this.timeStartPos=this.$refs.calendar.timeStartPos(this.currentTime,!1)},badgeClasses(e,t){const l=t==="header";return{[`text-white bg-${e.bgcolor}`]:!0,"full-width":!l&&(!e.side||e.side==="full"),"left-side":!l&&e.side==="left","right-side":!l&&e.side==="right","rounded-border":!0}},badgeStyles(e,t,l=void 0,s=void 0){const i={};return l&&s&&(i.top=l(e.time)+"px",i.height=s(e.duration)+"px"),i["align-items"]="flex-start",i},getEvents(e){const t=this.eventsMap[e]||[];if(t.length===1)t[0].side="full";else if(t.length===2){const l=q(re(t[0].date),{minute:ne(t[0].time)}),s=q(l,{minute:t[0].duration}),i=q(re(t[1].date),{minute:ne(t[1].time)}),a=q(i,{minute:t[1].duration});de(i,l,s,!0)||de(a,l,s,!0)?(t[0].side="left",t[1].side="right"):(t[0].side="full",t[1].side="full")}return t},onToday(){this.$refs.calendar.moveToToday()},onPrev(){this.$refs.calendar.prev()},onNext(){this.$refs.calendar.next()},onMoved(e){},onChange(e){},onClickDate(e){},onClickTime(e){},onClickInterval(e){},onClickHeadIntervals(e){},onClickHeadDay(e){}},mounted(){C.quickListsIsMobile()&&(this.view="day")},watch:{loading(e,t){e||(this.adjustCurrentTime(),setInterval(()=>{this.adjustCurrentTime()},6e4))}}},Nt={class:"subcontent"},Gt={key:0,class:"text-center q-pa-md"},qt={style:{display:"flex","max-width":"100%",width:"100%"}},jt={style:{display:"flex","justify-content":"center","flex-wrap":"wrap",padding:"2px"}},Ut={class:"title q-calendar__ellipsis"},Wt=["onClick"],Ht={class:"title q-calendar__ellipsis"},zt={class:"row justify-center"},Qt={class:"q-pa-md q-gutter-sm row"};function Zt(e,t,l,s,i,a){const u=k("q-calendar-day"),r=k("CalendarNavigationBar"),c=k("RecordFieldsForDisplayCustom"),h=k("RecordFieldsForDisplayGeneric");return n(),d("div",null,[_("div",null,[_("div",Nt,[l.loading?(n(),d("div",Gt," Loading... ")):g("",!0),_("div",{style:M(`display: ${l.loading?"none":"block"};`)},[_("div",qt,[o(u,{ref:"calendar",modelValue:i.selectedDate,"onUpdate:modelValue":t[0]||(t[0]=p=>i.selectedDate=p),view:i.view,"short-weekday-label":"","date-header":"stacked","weekday-align":"center","date-align":"center",animated:"",bordered:"",onChange:a.onChange,onMoved:a.onMoved,onClickDate:a.onClickDate,onClickTime:a.onClickTime,onClickInterval:a.onClickInterval,onClickHeadIntervals:a.onClickHeadIntervals,onClickHeadDay:a.onClickHeadDay,"interval-height":20,"interval-start":5,"interval-count":19,"hour24-format":"",weekdays:[1,2,3,4,5,6,0],"no-active-date":""},{"day-container":m(({scope:{days:p}})=>[a.hasDate(p)?(n(),d(b,{key:0},[_("div",{class:"day-view-current-time-indicator",style:M(a.style)},null,4),_("div",{class:"day-view-current-time-line",style:M(a.style)},null,4)],64)):g("",!0)]),"head-day-event":m(({scope:{timestamp:p}})=>[_("div",jt,[(n(!0),d(b,null,O(a.eventsMap[p.date],I=>(n(),d(b,{key:I.id},[I.time?(n(),f(oe,{key:1,class:V(a.badgeClasses(I,"header")),style:M([a.badgeStyles(I,"header"),{margin:"1px",width:"10px","max-width":"10px",height:"10px","max-height":"10px",cursor:"pointer"}]),onClick:S=>a.showEvent(I)},{default:m(()=>[o(W,null,{default:m(()=>[v(D(I.time+" - "+I.title),1)]),_:2},1024)]),_:2},1032,["class","style","onClick"])):(n(),f(oe,{key:0,class:V(a.badgeClasses(I,"header")),style:M([a.badgeStyles(I,"header"),{width:"100%",cursor:"pointer",height:"12px","font-size":"10px",margin:"1px"}])},{default:m(()=>[_("div",Ut,[v(D(I.title)+" ",1),o(W,null,{default:m(()=>[v(D(I.title),1)]),_:2},1024)])]),_:2},1032,["class","style"]))],64))),128))])]),"day-body":m(({scope:{timestamp:p,timeStartPos:I,timeDurationHeight:S}})=>[(n(!0),d(b,null,O(a.getEvents(p.date),T=>(n(),d(b,{key:T.id},[T.time!==void 0?(n(),d("div",{key:0,onClick:Y=>a.showEvent(T),class:V(["my-event",a.badgeClasses(T,"body")]),style:M(a.badgeStyles(T,"body",I,S))},[_("div",Ht,[v(D(T.title)+" ",1),o(W,null,{default:m(()=>[v(D(T.time),1)]),_:2},1024)])],14,Wt)):g("",!0)],64))),128))]),_:1},8,["modelValue","view","onChange","onMoved","onClickDate","onClickTime","onClickInterval","onClickHeadIntervals","onClickHeadDay"])]),_("div",zt,[_("div",Qt,[o(r,{onToday:a.onToday,onPrev:a.onPrev,onNext:a.onNext},null,8,["onToday","onPrev","onNext"]),o(E,{modelValue:i.view,"onUpdate:modelValue":t[1]||(t[1]=p=>i.view=p),options:[{label:"Week",value:"week"},{label:"Day",value:"day"}],"option-label":"label","option-value":"value",emitValue:"",mapOptions:"",dense:"",filled:"","hide-details":"",class:"",label:"View"},null,8,["modelValue"])])])],4)]),o(L,{modelValue:i.viewItemData.showModal,"onUpdate:modelValue":t[2]||(t[2]=p=>i.viewItemData.showModal=p),"max-width":"800px"},{default:m(()=>[o(P,{class:"q-pa-none"},{default:m(()=>[l.templateListGrid&&l.templateListGrid.cols?(n(),f(c,{key:0,item:i.viewItemData.data,maxFields:6,childRelations:[],isSummary:"",superOptions:l.superOptions,template:l.templateListGrid,onEditItem:a.editItem,onDeleteItem:a.deleteItem,unClickable:l.unClickable||!l.superOptions.model.rules.readable(i.viewItemData.data),onClickRow:a.clickRow},null,8,["item","superOptions","template","onEditItem","onDeleteItem","unClickable","onClickRow"])):(n(),f(h,{key:1,item:i.viewItemData.data,maxFields:6,superOptions:l.superOptions,onEditItem:a.editItem,onDeleteItem:a.deleteItem,unClickable:l.unClickable,onClickRow:a.clickRow},null,8,["item","superOptions","onEditItem","onDeleteItem","unClickable","onClickRow"]))]),_:1})]),_:1},8,["modelValue"])])])}const Jt=F(Yt,[["render",Zt],["__file","SuperTableCalendar.vue"]]),Xt={name:"SuperTableGrid",components:{RecordFieldsForDisplayGeneric:j,RecordFieldsForDisplayCustom:Z},props:{loading:{type:Boolean,default(){return!1}},excludedCols:{type:Array,default(){return[]}},unClickable:{type:Boolean,default(){return!1}},templateListGrid:{type:Object,default(){return{}}},items:{type:Array,default(){return[]}},superOptions:{type:Object,default(){return{headers:[],modelFields:[],displayMapField:!1,model:{},canEdit:!1,currentParentRecord:{}}}}},methods:{colClasses(e=12){e=+e;const t={lg:1,md:1.5,sm:2,xs:4};function l(r){return[1,2,3,4,6,12].reduce((h,p)=>Math.abs(p-r)<Math.abs(h-r)?p:h)}const s=l(e*t.lg),i=l(e*t.md),a=l(e*t.sm),u=l(e*t.xs);return`col-${s} col-lg-${s} col-md-${i} col-sm-${a} col-xs-${u}`},deleteItem(e){this.$emit("deleteItem",e)},editItem(e){this.$emit("editItem",e)},clickRow(e){this.$emit("clickRow",e[this.superOptions.model.primaryKey],e)}}},$t={class:"row q-col-gutter-md q-mx-n2 justify-center"},el={class:"q-card q-mx-auto",style:{height:"100%",overflow:"hidden"}},tl={key:1,class:V("col-12 col-md-3 ")},ll={class:"q-card q-mx-auto",style:{height:"100%"}},al={key:0,class:"text-center q-pa-md"},il={key:1,class:"text-center q-pa-md"};function sl(e,t,l,s,i,a){const u=k("RecordFieldsForDisplayCustom"),r=k("RecordFieldsForDisplayGeneric");return n(),d("div",null,[_("div",$t,[(n(!0),d(b,null,O(l.items,c=>(n(),d(b,{key:c.name},[l.templateListGrid&&l.templateListGrid.cols?(n(),d("div",{key:0,class:V(a.colClasses(l.templateListGrid.colWidth?l.templateListGrid.colWidth:3))},[_("div",el,[o(u,{item:c,onClickRow:a.clickRow,maxFields:6,childRelations:[],isSummary:"",superOptions:l.superOptions,template:l.templateListGrid,onEditItem:a.editItem,onDeleteItem:a.deleteItem,unClickable:l.unClickable||!l.superOptions.model.rules.readable(c)},null,8,["item","onClickRow","superOptions","template","onEditItem","onDeleteItem","unClickable"])])],2)):(n(),d("div",tl,[_("div",ll,[o(r,{item:c,onClickRow:a.clickRow,maxFields:6,superOptions:l.superOptions,onEditItem:a.editItem,onDeleteItem:a.deleteItem,unClickable:l.unClickable},null,8,["item","onClickRow","superOptions","onEditItem","onDeleteItem","unClickable"])])]))],64))),128))]),l.items.length?g("",!0):(n(),d(b,{key:0},[l.loading?(n(),d("div",al,"Loading...")):(n(),d("div",il,"No data available"))],64))])}const nl=F(Xt,[["render",sl],["__file","SuperTableGrid.vue"]]),rl={name:"SuperTableTable",components:{DatapointForDisplay:fe,DatapointForDisplayInner:K},props:{hidePagination:{type:Boolean,default(){return!1}},templateListTable:{type:Object,default(){return{}}},items:{type:Array,default(){return[]}},options:{type:Object,default(){return{}}},itemsLength:{type:Number,default(){return null}},loading:{type:Boolean,default(){return!1}},excludedCols:{type:Array,default(){return[]}},model:{type:[Object,Function],required:!0},displayMapField:{type:Boolean,required:!1},canEdit:{type:Boolean,required:!1}},data(){return{sortBy:[],pagination:{page:1,rowsPerPage:10,sortBy:[],descending:!1}}},computed:{superOptions(){return{headers:this.headers,modelFields:this.modelFields,displayMapField:this.displayMapField,model:this.model,canEdit:this.canEdit}},headers(){return C.SupaerTableHeaders(this.model,this.excludedCols,this.canEdit,this.displayMapField)},modelFields(){return C.computedAttrs(this.model,this.excludedCols)},pKey(){return this.superOptions.model.primaryKey},optionsComputed:{get(){return this.options},set(e){this.$emit("update:options",e)}},flattenedHeaders(){let e=[];if(this.templateListTable.length)for(const t of this.templateListTable){const l=this.superOptions.headers.find(i=>i.field===t.field);let s={};if(typeof l!="undefined")s=l,typeof t.label!="undefined"&&(s.label=t.label),s.userConfig=t;else{let i="";typeof t.label!="undefined"&&!t.hideLabel&&(i=t.label);let a="";typeof t.field!="undefined"&&(a=t.field),s={align:"left",dataType:"attr",field:a,label:i,meta:{},name:a,sortable:!!a.length,usageType:"normal",userConfig:t}}e.push(s)}else for(const t of this.superOptions.headers)if(e.push(t),t.headerParentFields)for(const l of t.headerParentFields)e.push({...l,userConfig:{}});return e},flattenedHeadersHideMapField(){let e=[];for(const t of this.flattenedHeaders)(!t.meta||!t.meta.hideField)&&(this.superOptions.superOptions||!t.usageType.startsWith("relLookupMapExtra")&&!t.usageType.startsWith("mapExtra"))&&e.push(t);return e}},methods:{tableRowClassFn(e){let t="ccc";return this.model.rules.readable(e.row)&&(t="hhh"),t},updateOptions(e){this.$emit("update:options",e)},deleteItem(e){this.$emit("deleteItem",e)},editItem(e){this.$emit("editItem",e)},clickRow(e){this.model.rules.readable(e)&&this.$emit("clickRow",e[this.model.primaryKey],e)},onRequest(e){const{page:t,rowsPerPage:l,sortBy:s,descending:i}=e.pagination;this.pagination={...this.pagination,page:t,rowsPerPage:l,sortBy:s,descending:i},this.$emit("update:options",{page:t,rowsPerPage:l,sortBy:s,descending:i})}},watch:{options:{handler(e){var t,l;this.pagination={...this.pagination,page:e.page,rowsPerPage:e.itemsPerPage,sortBy:((t=e.sortBy[0])==null?void 0:t.key)||this.pKey,descending:((l=e.sortBy[0])==null?void 0:l.order)==="desc"||!1}},deep:!0},"editItemData.showModal"(e){e||(this.editItemData.data={})}},mounted(){this.sortBy=[{key:this.pKey,order:"asc"}]}},dl={key:0},ol={key:1},ul={key:0,class:"text-center q-pa-md"};function ml(e,t,l,s,i,a){const u=k("DatapointForDisplay");return n(),d("div",null,[o(Pe,{"table-row-class-fn":a.tableRowClassFn,class:"qTable",rows:l.items,columns:a.flattenedHeadersHideMapField,"row-key":"id","rows-per-page-options":[10,20,30,50,100],pagination:i.pagination,loading:l.loading,onRequest:a.onRequest,hideBottom:l.hidePagination},{body:m(r=>[o(Se,{props:r,onClick:c=>a.clickRow(r.row),"no-hover":!l.model.rules.readable(r.row)},{default:m(()=>[(n(!0),d(b,null,O(a.flattenedHeaders,c=>(n(),f(Ve,{key:c.field,props:r},{default:m(()=>[c.isChildOf?(n(),d("div",dl,[o(u,{item:r.row[c.isChildOf.value],superOptions:a.superOptions,childRelations:[],dataPoint:c.userConfig,header:c,hideLabel:"",onEditItem:a.editItem,onDeleteItem:a.deleteItem},null,8,["item","superOptions","dataPoint","header","onEditItem","onDeleteItem"])])):(n(),d("div",ol,[o(u,{item:r.row,superOptions:a.superOptions,childRelations:[],dataPoint:c.userConfig,header:c,hideLabel:"",onEditItem:a.editItem,onDeleteItem:a.deleteItem},null,8,["item","superOptions","dataPoint","header","onEditItem","onDeleteItem"])]))]),_:2},1032,["props"]))),128))]),_:2},1032,["props","onClick","no-hover"])]),_:1},8,["table-row-class-fn","rows","columns","pagination","loading","onRequest","hideBottom"]),!l.items.length&&!l.loading?(n(),d("div",ul," No items ")):g("",!0)])}const cl=F(rl,[["render",ml],["__scopeId","data-v-7cdabf76"],["__file","SuperTableTable.vue"]]),hl={name:"SuperTableMap",components:{RecordFieldsForDisplayCustom:Z,DatapointForDisplayInner:K,MyGoogleMap:Lt,RecordFieldsForDisplayGeneric:j},props:{templateListGrid:{type:Object,default(){return{}}},unClickable:{type:Boolean,default(){return!1}},items:{type:Array,default(){return[]}},mapHeaders:{type:Array,default(){return[]}},superOptions:{type:Object,default(){return{headers:[],modelFields:[],displayMapField:!1,model:{},canEdit:!1,currentParentRecord:{}}}}},data(){return{locationHasBeenGranted:!1,zoom:2,geolocation:Re(),center:{lat:0,lng:0},geoLocate:{},selectedPlaceIndex:null,clusterStyle:{textColor:"white",url:"/mapIconCluster.svg",anchorText:[1.5,1]},viewItemData:{showModal:!1,data:{}}}},computed:{clusterStyles(){return[{...this.clusterStyle,height:40,width:40},{...this.clusterStyle,height:40,width:40},{...this.clusterStyle,height:40,width:40},{...this.clusterStyle,height:40,width:40},{...this.clusterStyle,height:40,width:40}]},markers(){let e=[],t=this.mapHeaders.find(s=>s.usageType=="mapExtraGeoLocLong"),l=this.mapHeaders.find(s=>s.usageType=="mapExtraGeoLocLat");if(console.log(t),l&&t)for(const s of this.items)[null,""].includes(s[l.name])||e.push({position:{lat:+s[l.name],lng:+s[t.name]},keys:{long:t.name,lat:l.name},meta:s});else{let s="";for(const i of this.mapHeaders)if(s=i.field,i.headerParentFields&&(t=i.headerParentFields.find(a=>a.usageType=="mapExtraGeoLocLong"),l=i.headerParentFields.find(a=>a.usageType=="mapExtraGeoLocLat"),l&&t))break;if(l&&t)for(const i of this.items)i[l.name]!==null&&e.push({position:{lat:i[s][l.name],lng:i[s][t.name]},keys:{long:t.name,lat:l.name},meta:i})}return e}},methods:{deleteItem(e){this.$emit("deleteItem",e)},editItem(e){this.$emit("editItem",e)},clickRow(e){this.viewItemData.showModal=!1,this.$emit("clickRow",e[this.superOptions.model.primaryKey],e)},position(e){return{lng:Number(e.lng),lat:Number(e.lat)}},positionString(e){return e.lat+", "+e.lng},markerOptionsMethod(e,t){return t==this.selectedPlaceIndex?this.selectedMarkerOptions(e,t):this.markerOptions(e,t)},clickedMarker(e,t){this.viewItemData.showModal=!0,this.viewItemData.data=e.meta,this.selectedPlaceIndex=t},markerOptions(e){return{id:e.meta.id,url:"/mapIconPin.svg",size:{width:30,height:30,f:"px",b:"px"},scaledSize:{width:30,height:30,f:"px",b:"px"}}},selectedMarkerOptions(e){return{id:e.meta.id,url:"/mapIconPin.svg",size:{width:40,height:40,f:"px",b:"px"},scaledSize:{width:40,height:40,f:"px",b:"px"}}}},mounted(){},watch:{"geolocation.coords.latitude"(){if(!this.locationHasBeenGranted){this.locationHasBeenGranted=!0,this.center={lng:this.geolocation.coords.longitude,lat:this.geolocation.coords.latitude};let e=2;this.geolocation.coords.accuracy<=100||this.geolocation.coords.altitude?e=9:this.geolocation.coords.accuracy<=1e3?e=8:e=7,this.zoom=e}}}};function pl(e,t,l,s,i,a){const u=k("MyGoogleMap"),r=k("RecordFieldsForDisplayCustom"),c=k("RecordFieldsForDisplayGeneric");return n(),d("div",null,[o(P,{class:"q-pa-xs"},{default:m(()=>[a.markers.length?(n(),f(u,{key:0,markers:a.markers,modelValue:i.center,"onUpdate:modelValue":t[0]||(t[0]=h=>i.center=h),zoom:i.zoom,onClickMarker:a.clickedMarker},null,8,["markers","modelValue","zoom","onClickMarker"])):g("",!0)]),_:1}),o(L,{modelValue:i.viewItemData.showModal,"onUpdate:modelValue":t[1]||(t[1]=h=>i.viewItemData.showModal=h),"max-width":"800px"},{default:m(()=>[o(P,{class:"q-pa-none"},{default:m(()=>[l.templateListGrid&&l.templateListGrid.cols?(n(),f(r,{key:0,item:i.viewItemData.data,maxFields:6,childRelations:[],isSummary:"",superOptions:l.superOptions,template:l.templateListGrid,onEditItem:a.editItem,onDeleteItem:a.deleteItem,unClickable:l.unClickable||!l.superOptions.model.rules.readable(i.viewItemData.data),onClickRow:a.clickRow},null,8,["item","superOptions","template","onEditItem","onDeleteItem","unClickable","onClickRow"])):(n(),f(c,{key:1,item:i.viewItemData.data,maxFields:6,superOptions:l.superOptions,onEditItem:a.editItem,onDeleteItem:a.deleteItem,unClickable:l.unClickable,onClickRow:a.clickRow},null,8,["item","superOptions","onEditItem","onDeleteItem","unClickable","onClickRow"]))]),_:1})]),_:1},8,["modelValue"])])}const fl=F(hl,[["render",pl],["__file","SuperTableMap.vue"]]),yl={name:"SuperTableList",components:{RecordFieldsForDisplayCustom:Z,DatapointForDisplayInner:K},props:{items:{type:Array,default(){return[]}},modelValue:{type:Number,default:null},superOptions:{type:Object,default(){return{headers:[],modelFields:[],displayMapField:!1,model:{},canEdit:!1,currentParentRecord:{}}}}},methods:{clickRow(e){this.$emit("update:modelValue",e.id)},deleteItem(e){this.$emit("deleteItem",e)},editItem(e){this.$emit("editItem",e)}},computed:{title(){return this.superOptions.headers.find(e=>e.field!=="id")}}},gl={style:{"max-height":"330px","overflow-y":"scroll"}};function bl(e,t,l,s,i,a){const u=k("DatapointForDisplayInner");return n(),d("div",gl,[o(Ee,{dense:""},{default:m(()=>[o(ue,{header:"","model-value":l.modelValue,color:"primary"},{default:m(()=>[(n(!0),d(b,null,O(l.items,(r,c)=>(n(),f(H,{key:c,value:r.id,onClick:h=>a.clickRow(r)},{default:m(()=>[o($,null,{default:m(()=>[o(ue,null,{default:m(()=>[o(u,{header:a.title,item:r,onEditItem:a.editItem,onDeleteItem:a.deleteItem},null,8,["header","item","onEditItem","onDeleteItem"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["value","onClick"]))),128))]),_:1},8,["model-value"])]),_:1})])}const kl=F(yl,[["render",bl],["__file","SuperTableList.vue"]]),_l=z(()=>Q(()=>import("./CreateEditForm.js"),__vite__mapDeps([0,1,2,3,4]))),Il=z(()=>Q(()=>Promise.resolve().then(()=>le),void 0)),wl={name:"SuperTable",components:{SearchGooglePlace:ze,RecordFieldsForDisplayGeneric:j,RelationComponent:Ge,CreateButton:Be,DestructableExpansionPanels:Dt,FilterPlace:Ot,FilterTime:Vt,SuperSelect:pe,SuperTableList:kl,SuperTableMap:fl,SuperTableTable:cl,SuperTableGrid:nl,SuperTableCalendar:Jt,CreateEditForm:_l,SuperTable:Il},props:{justCreateButton:{type:Boolean,default:!1},createButtonText:{type:String,default:""},disabled:{type:Boolean,default:!1},allowedFilters:{type:Array,default:null},allowAll:{type:Boolean,default:!1},hideLabel:{type:Boolean,default(){return!1}},templateForm:{type:Object,default(){return{}}},viewAs:{type:Object,default(){return{show:["table","grid","map","calendar"],default:"table"}}},hideCreate:{type:Boolean,default(){return!1}},forcedFilters:{type:Object,default(){return{}}},templateListTable:{type:Object,default(){return{}}},templateListGrid:{type:Object,default(){return{}}},model:{type:[Object,Function],required:!0},hidePagination:{type:Boolean,default(){return!1}},displayMapField:{type:Boolean,default(){return!1}},isForSelectingRelation:{type:Boolean,default(){return!1}},modelValue:{type:[Number,Object,String],default(){return null}},showMap:{type:Boolean,default(){return!1}},unClickable:{type:Boolean,default(){return!1}},parentKeyValuePair:{type:Object,default(){return{}}},createPayloadExtras:{type:Object,default(){return{}}},relationships:{type:Array,default(){return[]}},fetchFlags:{type:Object,default(){return{}}},defaultViewModeProp:{type:String,default(){return""}},rules:{type:Array,default(){return[()=>!0]}},modelField:{type:Object,default:()=>({})},errorMessage:{type:String,default(){return null}}},data(){return{saving:!1,search:"",formServerErrors:{},deleteItemData:{showModal:!1,data:null},editItemData:{showModal:!1,data:null},years:Array.from({length:5},(e,t)=>new Date().getFullYear()-t),itemsLength:1,activated:!1,loading:!1,options:{page:1,itemsPerPage:10,sortBy:[],groupBy:[]},createItemData:{showModal:!1,data:{}},highlightedRow:null,filters:{},items:[],activeTab:"table"}},computed:{tabOptions(){let e=[];return this.viewAs.show.includes("grid")&&e.push({label:"Grid",value:"grid"}),this.viewAs.show.includes("map")&&e.push({label:"Map",value:"map"}),this.viewAs.show.includes("calendar")&&e.push({label:"Calendar",value:"calendar"}),this.viewAs.show.includes("table")&&e.push({label:"Table",value:"table"}),e},optionsComputed:{get(){return this.options},set(e){this.loading||this.fetchData(),this.options=e}},parentField(){return this.superOptions.modelFields.find(t=>t.name==this.parentKeyValuePair.parentFKey)},canCreateComputed(){if(this.parentField&&typeof this.parentField.fieldExtras.linkablesRule=="function"){const e=this.parentField.fieldExtras.linkablesRule();if(e[this.model.primaryKey]&&this.parentKeyValuePair.parentFVal&&!e[this.model.primaryKey].split(",").map(Number).includes(this.parentKeyValuePair.parentFVal))return!1}return!0},superOptions(){return{headers:this.headers,modelFields:this.modelFields,displayMapField:this.displayMapField,model:this.model,canEdit:this.canEdit}},excludedCols(){let e=[];return this.parentKeyValuePair.parentFKey&&(e=[this.parentKeyValuePair.parentFKey]),e},canEdit(){return this.model.rules.creatable()},filtersComp(){const e={...this.filters,...this.forcedFilters};return this.parentKeyValuePair.parentFKey&&this.parentKeyValuePair.parentFVal&&(e[this.parentKeyValuePair.parentFKey]=this.parentKeyValuePair.parentFVal),e},quickListsIsMobile(){return C.quickListsIsMobile()},filterInputs(){const e=this.modelFields,t=[];for(const l of e)if(l.usageType.startsWith("relForeignKeyNormal")||l.usageType=="timeRangeStart")t.push(l);else if(l.usageType=="relForeignKeyMapExtraRelSublocality"){const s=e.filter(i=>i.usageType.startsWith("relForeignKeyMapExtraRel"));t.push({label:"Place",name:"Place",usageType:"mapFilter",dataType:"normal",children:s})}return t},headers(){return C.SupaerTableHeaders(this.model,this.excludedCols,this.canEdit,this.displayMapField)},mapHeaders(){return C.SupaerTableHeaders(this.model,this.excludedCols,this.canEdit,!0)},modelFields(){return C.computedAttrs(this.model,this.excludedCols)},pKey(){return this.model.primaryKey},maxPages(){return Math.ceil(this.itemsLength/this.options.itemsPerPage)}},methods:{shouldWeShowTopBar(){let e=!1;return(this.viewAs.show.length||this.filterInputs.length&&(this.allowedFilters==null||this.filterInputs.some(t=>this.allowedFilters.includes(t.name)))||this.model.titleKey!==this.model.primaryKey)&&(e=!0),e},doSearch(e){this.filters[this.model.titleKey]=e,this.fetchData()},deleteItem(e){this.$emit("deleteItem",e),this.deleteItemData.data=e,this.deleteItemData.showModal=!0},deleteItemSubmit(){this.superOptions.model.Delete(this.deleteItemData.data.id).then(()=>{this.fetchData()}),this.deleteItemData.showModal=!1},editItem(e){this.$emit("editItem",e),this.editItemData.data={...e},this.editItemData.showModal=!0},editItemSubmit(){const e=C.preparePayload(this.editItemData.data,this.superOptions.modelFields);this.superOptions.model.Update(e,[],{},{"Content-Type":"multipart/form-data"}).then(()=>{this.fetchData(),this.editItemData.showModal=!1,this.formServerErrors={}}).catch(t=>{this.formServerErrors=t.response.data})},pageUpdate(e){this.options={...this.options,page:e},this.fetchData()},updatePagination(e){this.options={...this.options,page:e.page,itemsPerPage:e.rowsPerPage,sortBy:e.sortBy,descending:e.descending},this.fetchData()},quickListsGetIfMatchesAllChecks(e,t){return C.quickListsGetIfMatchesAllChecks(e,t)},formatTimestamp(e){return e?w.tz(e,"YYYY-MM-DDTHH:mm:ss.SSSSSSZ","UTC").tz("Africa/Johannesburg").format("dddd, MMMM D, YYYY h:mm A"):null},createNewInstance(){return new this.model},clickRow(e,t){this.isForSelectingRelation&&(this.highlightedRow=e),this.model.rules.readable(t)&&this.$emit("clickRow",e,t,this.$router),this.$emit("update:modelValue",e)},createItem(){this.createItemData.showModal=!0},createItemSubmit(){if(this.saving)return;this.saving=!0;let e=C.preparePayload(this.createItemData.data,this.modelFields);delete e.id,this.items.length;let t={};this.superOptions.modelFields.find(s=>s.usageType=="fileImageType")&&(t={"Content-Type":"multipart/form-data"}),this.model.Store({...e,...this.createPayloadExtras},[],{},t).then(()=>{this.saving=!1,this.fetchData(),this.createItemData.data={},this.createItemData.showModal=!1,this.formServerErrors={}}).catch(s=>{this.saving=!1,this.formServerErrors=s.response.data})},applyFilters(e,t){const l={};return Object.keys(t).forEach(s=>{const[i,a]=s.split(".");l[i]||(l[i]={}),l[i][a]=t[s]}),e.filter(s=>Object.keys(l).every(i=>{const a=l[i];return s[i]?s[i].some(u=>Object.keys(a).every(r=>u[r]===a[r])):!1}))},async fetchData(){var a,u,r,c,h;if(!this.activated&&this.isForSelectingRelation)return;this.loading=!0;let e=[];(a=this.model.rules)!=null&&a.readables&&(e=this.model.rules.readables());let t={},l={};this.model.adapator=="supabase"?(t={Prefer:"count=exact"},l={order:"id.desc"}):this.model.adapator=="laravel"&&(t={},l={sort:`-${this.model.primaryKey}`,per_page:this.options.itemsPerPage,page:this.options.page});const s=await this.model.FetchAll(this.relationships,{...e,...l,...this.fetchFlags},t,{page:this.options.page,limit:this.options.itemsPerPage,filters:this.filtersComp,clearPrimaryModelOnly:!1});this.items=s.response.data.data,this.loading=!1;let i=0;this.model.adapator=="supabase"?(r=(u=s==null?void 0:s.response)==null?void 0:u.headers)!=null&&r["content-range"]&&(i=((h=(c=s==null?void 0:s.response)==null?void 0:c.headers)==null?void 0:h["content-range"]).split("/")[1]):this.model.adapator=="laravel"&&(i=s.response.data.total),this.itemsLength=i},activateAndFetchData(){!this.activated&&!this.disabled&&(this.activated=!0,this.fetchData())}},watch:{search(e){this.disabled||(this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.doSearch(e)},300))},filters:{handler(){!this.loading&&!this.justCreateButton&&this.fetchData()},deep:!0},"createItemData.showModal"(e){e&&(this.createItemData.data=this.createNewInstance(),this.parentKeyValuePair.parentFKey&&this.parentKeyValuePair.parentFVal&&(this.createItemData.data[this.parentKeyValuePair.parentFKey]=this.parentKeyValuePair.parentFVal))}},mounted(){this.$emit("superTableMounted"),this.activeTab=this.viewAs.default;for(const e of this.modelFields)e.usageType.startsWith("relForeignKey")||e.dataType.startsWith("mapExtraRel")?this.filters[e.name]=null:e.usageType=="timeRangeStart"&&(this.filters[e.name]={value:null,usageType:"timeRangeStart"});(this.activated||!this.isForSelectingRelation)&&(this.justCreateButton||this.fetchData())}},Fl={key:0,class:"q-mb-md"},vl={key:0,class:""},Dl={class:"row items-center wrap"},Cl={key:0,class:"q-mr-sm"},Ml={class:""},Tl={key:1,class:""},Ol=_("div",{class:"text-h6"},"Delete Item",-1),xl=_("p",null,"Are you sure you want to delete this item?",-1);function Sl(e,t,l,s,i,a){const u=k("CreateButton"),r=k("SuperSelect"),c=k("SuperTable",!0),h=k("FilterTime"),p=k("FilterPlace"),I=k("DestructableExpansionPanels"),S=k("SuperTableTable"),T=k("SuperTableGrid"),Y=k("SuperTableMap"),J=k("SuperTableCalendar"),ae=k("CreateEditForm");return n(),d("div",null,[a.canCreateComputed&&a.canEdit&&!l.hideCreate&&!l.isForSelectingRelation?(n(),d("div",Fl,[e.$slots.create?B(e.$slots,"create",{key:0}):(n(),d(b,{key:1},[a.superOptions.model.rules.creatable()?(n(),f(u,{key:0,modelFields:a.modelFields,onCreateItem:a.createItem,model:l.model,superOptions:a.superOptions,template:l.templateForm,createButtonText:l.createButtonText},null,8,["modelFields","onCreateItem","model","superOptions","template","createButtonText"])):g("",!0)],64))])):g("",!0),l.justCreateButton?g("",!0):(n(),d(b,{key:1},[l.isForSelectingRelation?(n(),f(r,{key:0,forcedFilters:l.forcedFilters,readonly:l.disabled,allowAll:l.allowAll,dense:"",hideLabel:l.hideLabel,page:i.options.page,"onUpdate:page":a.pageUpdate,maxPages:a.maxPages,onClick:a.activateAndFetchData,items:i.items,loading:i.loading,rules:l.rules,modelValue:+l.modelValue,"onUpdate:modelValue":a.clickRow,model:l.model,modelField:l.modelField,activated:i.activated,onSearch:a.doSearch,errorMessage:l.errorMessage},{default:m(()=>[a.superOptions.model.rules.creatable()&&a.canCreateComputed?(n(),f(u,{key:0,modelFields:a.modelFields,onCreateItem:a.createItem,model:l.model,superOptions:a.superOptions,template:l.templateForm,createButtonText:l.createButtonText},null,8,["modelFields","onCreateItem","model","superOptions","template","createButtonText"])):g("",!0)]),_:1},8,["forcedFilters","readonly","allowAll","hideLabel","page","onUpdate:page","maxPages","onClick","items","loading","rules","modelValue","onUpdate:modelValue","model","modelField","activated","onSearch","errorMessage"])):(n(),d(b,{key:1},[a.shouldWeShowTopBar()?(n(),d("div",vl,[o(I,{destroy:!a.quickListsIsMobile,title:"Settings"},{default:m(()=>[_("div",Dl,[l.viewAs.show.length?(n(),d("div",Cl,[o(E,{style:{width:"200px"},options:a.tabOptions,modelValue:i.activeTab,"onUpdate:modelValue":t[0]||(t[0]=y=>i.activeTab=y),label:"View As","option-label":"label","option-value":"value","emit-value":"","map-options":"",dense:"",class:"col-grow",filled:"",rules:[()=>!0]},null,8,["options","modelValue"])])):g("",!0),(n(!0),d(b,null,O(a.filterInputs,y=>(n(),d(b,{key:y.name},[typeof i.filters[y.name]!="undefined"&&(l.allowedFilters==null||l.allowedFilters.includes(y.name))?(n(),d(b,{key:0},[y.usageType.startsWith("relForeignKey")?(n(),f(c,{key:0,isForSelectingRelation:!0,canEdit:!1,modelValue:i.filters[y.name],"onUpdate:modelValue":N=>i.filters[y.name]=N,model:y.meta.field.parent,rules:[()=>!0],modelField:y,class:"q-mr-sm"},null,8,["modelValue","onUpdate:modelValue","model","modelField"])):g("",!0),y.usageType=="timeRangeStart"?(n(),f(h,{key:y.name,modelField:y,modelValue:i.filters[y.name].value,"onUpdate:modelValue":N=>i.filters[y.name].value=N,class:"q-ma-sm col-grow",style:{"max-width":"200px"}},null,8,["modelField","modelValue","onUpdate:modelValue"])):g("",!0)],64)):(n(),d(b,{key:1},[y.usageType=="mapFilter"?(n(),f(p,{key:y.name,filterField:y,modelValue:i.filters,"onUpdate:modelValue":t[1]||(t[1]=N=>i.filters=N),class:"q-ma-sm col-grow"},null,8,["filterField","modelValue"])):g("",!0)],64))],64))),128)),this.model.titleKey!==this.model.primaryKey?(n(),f(A,{key:1,modelValue:i.search,"onUpdate:modelValue":t[2]||(t[2]=y=>i.search=y),error:!1,"error-message":"",label:"Search",dense:"",filled:""},null,8,["modelValue"])):g("",!0)])]),_:1},8,["destroy"])])):g("",!0),_("div",Ml,[i.activeTab=="table"?(n(),d(b,{key:0},[o(S,{items:i.items,loading:i.loading,onClickRow:a.clickRow,templateListTable:l.templateListTable,hidePagination:l.hidePagination,excludedCols:a.excludedCols,model:l.model,displayMapField:l.displayMapField,canEdit:a.canEdit,onEditItem:a.editItem,onDeleteItem:a.deleteItem},null,8,["items","loading","onClickRow","templateListTable","hidePagination","excludedCols","model","displayMapField","canEdit","onEditItem","onDeleteItem"]),l.hidePagination?g("",!0):(n(),f(ce,{key:0,modelValue:i.options.page,"onUpdate:modelValue":[t[3]||(t[3]=y=>i.options.page=y),a.pageUpdate],max:a.maxPages,input:""},null,8,["modelValue","onUpdate:modelValue","max"]))],64)):g("",!0),i.activeTab=="grid"?(n(),d("div",Tl,[o(T,{items:i.items,onClickRow:a.clickRow,superOptions:a.superOptions,unClickable:l.unClickable,templateListGrid:l.templateListGrid,onEditItem:a.editItem,onDeleteItem:a.deleteItem,excludedCols:a.excludedCols,loading:i.loading},null,8,["items","onClickRow","superOptions","unClickable","templateListGrid","onEditItem","onDeleteItem","excludedCols","loading"])])):g("",!0),i.activeTab=="map"?(n(),f(Y,{key:2,mapHeaders:a.mapHeaders,items:i.items,onClickRow:a.clickRow,superOptions:a.superOptions,onEditItem:a.editItem,onDeleteItem:a.deleteItem,unClickable:l.unClickable,templateListGrid:l.templateListGrid},null,8,["mapHeaders","items","onClickRow","superOptions","onEditItem","onDeleteItem","unClickable","templateListGrid"])):g("",!0),i.activeTab=="calendar"?(n(),f(J,{key:3,items:i.items,onClickRow:a.clickRow,superOptions:a.superOptions,onEditItem:a.editItem,onDeleteItem:a.deleteItem,templateListGrid:l.templateListGrid,unClickable:l.unClickable,loading:i.loading},null,8,["items","onClickRow","superOptions","onEditItem","onDeleteItem","templateListGrid","unClickable","loading"])):g("",!0)])],64))],64)),a.canEdit?(n(),d(b,{key:2},[o(L,{modelValue:i.createItemData.showModal,"onUpdate:modelValue":[t[6]||(t[6]=y=>i.createItemData.showModal=y),t[7]||(t[7]=y=>{i.formServerErrors={}})]},{default:m(()=>[i.createItemData.showModal?(n(),f(ae,{key:0,titlePrefix:"New",modelValue:i.createItemData.data,"onUpdate:modelValue":t[4]||(t[4]=y=>i.createItemData.data=y),onSubmit:a.createItemSubmit,onCancel:t[5]||(t[5]=y=>{i.createItemData.showModal=!1,i.formServerErrors={}}),superOptions:a.superOptions,style:{width:"700px","max-width":"delete me"},template:l.templateForm,formServerErrors:i.formServerErrors},null,8,["modelValue","onSubmit","superOptions","template","formServerErrors"])):g("",!0)]),_:1},8,["modelValue"]),a.superOptions.canEdit?(n(),d(b,{key:0},[o(L,{modelValue:i.editItemData.showModal,"onUpdate:modelValue":[t[10]||(t[10]=y=>i.editItemData.showModal=y),t[11]||(t[11]=y=>{i.formServerErrors={}})]},{default:m(()=>[i.editItemData.showModal?(n(),f(ae,{key:0,titlePrefix:"Edit",modelValue:i.editItemData.data,"onUpdate:modelValue":t[8]||(t[8]=y=>i.editItemData.data=y),onSubmit:a.editItemSubmit,onCancel:t[9]||(t[9]=y=>{i.editItemData.showModal=!1,i.formServerErrors={}}),superOptions:a.superOptions,template:l.templateForm,style:{width:"700px","max-width":"delete me"},formServerErrors:i.formServerErrors},null,8,["modelValue","onSubmit","superOptions","template","formServerErrors"])):g("",!0)]),_:1},8,["modelValue"]),o(L,{modelValue:i.deleteItemData.showModal,"onUpdate:modelValue":t[13]||(t[13]=y=>i.deleteItemData.showModal=y)},{default:m(()=>[o(P,{style:{width:"500px","max-width":"delete me"}},{default:m(()=>[o(R,{class:"q-pt-md q-pb-md q-pl-md q-pr-md"},{default:m(()=>[Ol]),_:1}),o(R,null,{default:m(()=>[xl]),_:1}),o(ee,{align:"right"},{default:m(()=>[o(x,{onClick:t[12]||(t[12]=y=>i.deleteItemData.showModal=!1),flat:""},{default:m(()=>[v("Cancel")]),_:1}),o(x,{onClick:a.deleteItemSubmit,color:"negative",flat:""},{default:m(()=>[v("Delete")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)):g("",!0)],64)):g("",!0)])}const Vl=F(wl,[["render",Sl],["__file","SuperTable.vue"]]),le=Object.freeze(Object.defineProperty({__proto__:null,default:Vl},Symbol.toStringTag,{value:"Module"}));export{Be as C,K as D,C as Q,Z as R,Vl as S,j as a,cl as b,pe as c,ze as d,Ge as e,fe as f,le as g};
